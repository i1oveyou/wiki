<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <title>IDA普通插件安装</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">IDA普通插件安装</span>
        <ul class="nav pull-right doc-info">
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">

        <ul>
        <li><a href="#插件安装" id="toc-插件安装">插件安装</a></li>
        <li><a href="#findcrypt3"
        id="toc-findcrypt3">findcrypt3</a></li>
        <li><a href="#flare-ida" id="toc-flare-ida">flare-ida</a></li>
        </ul>

        </div>
      </div>
            <div class="span9">

      
      <h1 id="插件安装">插件安装</h1>
<p>插件网站:</p>
<p><a
href="https://github.com/fr0gger/awesome-ida-x64-olly-plugin">https://github.com/fr0gger/awesome-ida-x64-olly-plugin</a></p>
<p><a
href="https://bbs.kanxue.com/thread-275530.htm">https://bbs.kanxue.com/thread-275530.htm</a></p>
<h1 id="findcrypt3">findcrypt3</h1>
<pre><code>https://blog.csdn.net/marosri/article/details/131171634</code></pre>
<p>下载脚本插件 <a
href="https://github.com/polymorf/findcrypt-yara">https://github.com/polymorf/findcrypt-yara</a></p>
<p>把 findcrypt3.py和findcrypt3.rules放到IDA7.5/plugins目录下</p>
<p>然后 python3安装yara-<a
href="https://so.csdn.net/so/search?q=python&amp;spm=1001.2101.3001.7020">python</a></p>
<p>一般情况下安装yara-python</p>
<pre><code>pip install yara-python</code></pre>
<p>如果能够打开IDA，使用findcrypto失败，然后报错，Typeerror:
‘yara.stringmatch’ object is not subscriptable</p>
<p>这个时候，可能可能需要卸载以前的yara-python</p>
<pre><code>pip uninstall yara-python</code></pre>
<p>然后安装下面这个版本的yara-python</p>
<pre><code>python -m pip install yara-python==3.11.0</code></pre>
<p>安装完毕后如何使用?</p>
<p>打开Edit&gt;Plugins&gt;Findcrypt， 或者用快捷键 Ctrl+Alt+F</p>
<p>如何添加一个算法被识别的规则?</p>
<p>为findcrypt3添加国密SM4算法的识别规则打开findcrypt3.rules，在最后添加</p>
<pre><code>rule SM4_FK {
    meta:
        author = &quot;Basstorm&quot;
        description = &quot;Look for SM4_FKbox constants&quot;
        date = &quot;2020-08&quot;
    strings:
        $c0 = { C6 BA B1 A3 50 33 AA 56 97 91 7D 67 DC 22 70 B2 }
    condition:
        $c0
}

rule SM4_CK {
    meta:
        author = &quot;Basstorm&quot;
        description = &quot;Look for SM4_CKbox constants&quot;
        date = &quot;2020-08&quot;
    strings:
        $c0 = { 15 0E 07 00 31 2A 23 1C 4D 46 3F 38 69 62 5B 54 85 7E 77 70 A1 9A 93 8C }
    condition:
        $c0
}
</code></pre>
<h1 id="flare-ida">flare-ida</h1>
<p>安装过程很难受,,,文档什么的都没有说清楚,,,</p>
<p>可能是自己文档读不清楚吧,,,哭死</p>
<p>下载</p>
<pre><code>https://github.com/mandiant/flare-ida</code></pre>
<p>好像要安装flare模块吧,不太知道,,,</p>
<pre><code>pip install -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com flare</code></pre>
<p>然乎就是把flare-ida项目中的</p>
<p>下载下来</p>
<pre><code>├─code_grafter
├─decompiler_scripts
├─examples
├─MSDN_crawler
├─plugins
├─python
│  └─flare
│      ├─IDB_MSDN_Annotator
│      │  └─img
│      ├─ironstrings
│      └─ui
└─shellcode_hashes</code></pre>
<p>把plugins目录移植到IDA中同名文件夹,不多说,这不是重点</p>
<p>重点是???</p>
<p>以IDA7.7为例,,,</p>
<p>需要把<code>/python/flare</code>移动到<code>IDA_Pro_7.7\python\3</code>中</p>
<figure>
<img src="./img/image-20240115180303304.png"
alt="image-20240115180303304" />
<figcaption aria-hidden="true">image-20240115180303304</figcaption>
</figure>
<p>然后就可以使用了</p>
<figure>
<img src="./img/image-20240115180330241.png"
alt="image-20240115180330241" />
<figcaption aria-hidden="true">image-20240115180330241</figcaption>
</figure>
<p>使用???</p>
<p>比如kali的反弹shell中payload用到的</p>
<figure>
<img src="./img/image-20240115182453043.png"
alt="image-20240115182453043" />
<figcaption aria-hidden="true">image-20240115182453043</figcaption>
</figure>
<p>然后使用我们的插件</p>
<p>数据库db选择GitHub下载后提供的</p>
<figure>
<img src="./img/image-20240115182703667.png"
alt="image-20240115182703667" />
<figcaption aria-hidden="true">image-20240115182703667</figcaption>
</figure>
<p>然后根据情况配置参数</p>
<figure>
<img src="./img/image-20240115182725675.png"
alt="image-20240115182725675" />
<figcaption aria-hidden="true">image-20240115182725675</figcaption>
</figure>
<p>然后点击ok就行</p>
<p>然后结果会显示在output窗口</p>
<figure>
<img src="./img/image-20240115182759424.png"
alt="image-20240115182759424" />
<figcaption aria-hidden="true">image-20240115182759424</figcaption>
</figure>
<p>http://chensh.top/2017/09/06/IDA-Plugin-FRIEND/</p>
<p>https://bbs.kanxue.com/thread-223156.htm</p>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
