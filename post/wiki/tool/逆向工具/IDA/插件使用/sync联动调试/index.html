<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <title>IDA插件-sync</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">IDA插件-sync</span>
        <ul class="nav pull-right doc-info">
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">

        <ul>
        <li><a href="#参考教程" id="toc-参考教程">参考教程</a></li>
        <li><a href="#单机调试" id="toc-单机调试">单机调试</a></li>
        <li><a href="#远程调试" id="toc-远程调试">远程调试</a></li>
        </ul>

        </div>
      </div>
            <div class="span9">

      
      <h1 id="参考教程">参考教程</h1>
<pre><code>https://azha0.github.io/2021/02/13/04_%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/ret-sync%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/

https://blog.csdn.net/lixiangminghate/article/details/95668806
https://blog.csdn.net/qq_36088602/article/details/106153225
https://blog.csdn.net/lixiangminghate/article/details/82631934</code></pre>
<p>环境</p>
<pre><code>IDA 7.6
x64debug
Python 3.8.9</code></pre>
<p>准备材料</p>
<p>Github项目地址：https://github.com/bootleg/ret-sync</p>
<p>Github项目地址：https://github.com/patois/dsync</p>
<p>Ret-sync分为两部分，</p>
<pre><code>一部分是IDA插件(python)，
另一部分是调试器插件（编译好的DLL）；</code></pre>
<p>该插件的功能是将调试器中的EIP所指的地址在IDA中同步显示出来。这样就可以将动静结合起来了。</p>
<p>ps:
此刻只是说,我们用的是x64debug去调试,,,IDA仍然需要在之前静态加载和分析目标文件</p>
<p>在ret-sync中,,,它给的是我们要去自己编译的源码,,,懂得都懂,,,</p>
<p>有些people他就是死活编译不出来</p>
<p>于是,,网上就出现了编译好的,然后提供下载</p>
<p>编译好的调试器插件可从Azure
DevOps下载，链接：https://dev.azure.com/bootlegdev/ret-sync-release/_build/results?buildId=105&amp;view=results</p>
<p>然后点击</p>
<figure>
<img src="./img/image-20231114210907005.png"
alt="image-20231114210907005" />
<figcaption aria-hidden="true">image-20231114210907005</figcaption>
</figure>
<p>然后把鼠标移动到右边</p>
<figure>
<img src="./img/image-20231114211008273.png"
alt="image-20231114211008273" />
<figcaption aria-hidden="true">image-20231114211008273</figcaption>
</figure>
<p>就可以实现点击下载</p>
<h1 id="单机调试">单机调试</h1>
<p>ps: 以IDA结合x64debug为例子</p>
<p>就是用(一个机器+2个调试器)来调试</p>
<p>首先把ret-sync/ret-sync/ext_ida的内容存入
<code>IDA76\plugins</code>目录</p>
<figure>
<img src="./img/image-20231114211856216.png"
alt="image-20231114211856216" />
<figcaption aria-hidden="true">image-20231114211856216</figcaption>
</figure>
<p>然后我们把dsync.py放入<code>IDA76\plugins</code>目录下</p>
<figure>
<img src="./img/image-20231114212116942.png"
alt="image-20231114212116942" />
<figcaption aria-hidden="true">image-20231114212116942</figcaption>
</figure>
<p>最后如下</p>
<figure>
<img src="./img/image-20231114212206718.png"
alt="image-20231114212206718" />
<figcaption aria-hidden="true">image-20231114212206718</figcaption>
</figure>
<p>然后我们来配置x64debug</p>
<p>比如我们调试的是x64的程序,我们把<code>x64dbg_sync.dp64</code>放到<code>\release\x64\plugins</code>目录中</p>
<figure>
<img src="./img/image-20231114212329645.png"
alt="image-20231114212329645" />
<figcaption aria-hidden="true">image-20231114212329645</figcaption>
</figure>
<p>然后就配置完了</p>
<p>然后开启调试过程</p>
<p>IDA加载程序</p>
<figure>
<img src="./img/image-20231114212917641.png"
alt="image-20231114212917641" />
<figcaption aria-hidden="true">image-20231114212917641</figcaption>
</figure>
<p>然后x64启动程序,先F9,</p>
<p>然后启动插件</p>
<figure>
<img src="./img/image-20231114213109175.png"
alt="image-20231114213109175" />
<figcaption aria-hidden="true">image-20231114213109175</figcaption>
</figure>
<p>然后IDA那边就自动附加上了</p>
<figure>
<img src="./img/image-20231114213128154.png"
alt="image-20231114213128154" />
<figcaption aria-hidden="true">image-20231114213128154</figcaption>
</figure>
<p>于是我们每在x64debug调试一步,IDA就会同步的显示EIP指针</p>
<p>好像,,我们只能在x64debug中调试,,然后在IDA中同步显示</p>
<p>无法实现在IDA中调试,,,x64debug也会跟着一起显示</p>
<figure>
<img src="./img/image-20231114213241569.png"
alt="image-20231114213241569" />
<figcaption aria-hidden="true">image-20231114213241569</figcaption>
</figure>
<p>可以看到左边界面,右边界面,感觉有点紧凑</p>
<p>如果你有2个屏幕,,一边看一个,另外一边看另外一个</p>
<p>那么就会很舒服</p>
<p>于是就产生了一个新的想法</p>
<p>双击调试</p>
<p>在真机使用x64debug,在虚拟机使用IDA</p>
<h1 id="远程调试">远程调试</h1>
<p>就是用(2个机器+2个工具)来调试</p>
<p>环境</p>
<pre><code>虚拟机(作为服务端): 使用IDA
物理机(作为客户端): 使用x64debug</code></pre>
<p>准备如下文件</p>
<p>服务端(IDA):
在用户的家目录中,准备一个名字叫做<code>.sync</code>的文本文件,然后带调试的demo.exe随便放在桌面上,</p>
<p>客户端(x64debug):
在当前目录,建一个文件夹,名字任意,然后里面有带调试的demo.exe,准备一个名字叫做<code>.sync</code>的文本文件</p>
<p>2个<code>.sync</code>文件的内容是一致的</p>
<p>内容如下</p>
<pre><code>[INTERFACE]
host=192.168.102.3
port=8089
</code></pre>
<p>host是服务端的IP,也就是有IDA那个</p>
<p>port任意,,最好别太任意</p>
<p>ps: 得保证物理机和虚拟机网络可以相通</p>
<p>然后服务的用IDA打开并静态分析demo.exe</p>
<p>然后IDA开启插件,ret-sync</p>
<p>初次反应如下</p>
<figure>
<img src="./img/image-20231115142956120.png"
alt="image-20231115142956120" />
<figcaption aria-hidden="true">image-20231115142956120</figcaption>
</figure>
<p>然后客户端,x64debug打开demo.exe,并F9到用户模块</p>
<p>然后打开插件</p>
<figure>
<img src="./img/image-20231115143847511.png"
alt="image-20231115143847511" />
<figcaption aria-hidden="true">image-20231115143847511</figcaption>
</figure>
<p>然后不出意外就结束了</p>
<figure>
<img src="./img/image-20231115143920138.png"
alt="image-20231115143920138" />
<figcaption aria-hidden="true">image-20231115143920138</figcaption>
</figure>
<figure>
<img src="./img/image-20231115143930006.png"
alt="image-20231115143930006" />
<figcaption aria-hidden="true">image-20231115143930006</figcaption>
</figure>
<p>可以看到2者是同步的</p>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
