<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <title>IDAè„šæœ¬ç¼–å†™-IDCè¯´æ˜æ–‡æ¡£</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">IDAè„šæœ¬ç¼–å†™-IDCè¯´æ˜æ–‡æ¡£</span>
        <ul class="nav pull-right doc-info">
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">

        <ul>
        <li><a href="#è¯´æ˜æ–‡æ¡£" id="toc-è¯´æ˜æ–‡æ¡£">è¯´æ˜æ–‡æ¡£</a></li>
        <li><a href="#å‚è€ƒé“¾æ¥" id="toc-å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</a></li>
        <li><a href="#æ•°æ®ç±»å‹" id="toc-æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></li>
        <li><a href="#å­—ç¬¦ä¸²æ“ä½œ"
        id="toc-å­—ç¬¦ä¸²æ“ä½œ">å­—ç¬¦ä¸²æ“ä½œ</a></li>
        <li><a href="#æ•°ç»„" id="toc-æ•°ç»„">æ•°ç»„</a></li>
        <li><a href="#è¿ç®—ç¬¦" id="toc-è¿ç®—ç¬¦">è¿ç®—ç¬¦</a></li>
        <li><a href="#å‡½æ•°å®šä¹‰" id="toc-å‡½æ•°å®šä¹‰">å‡½æ•°å®šä¹‰</a></li>
        <li><a href="#å®å®šä¹‰" id="toc-å®å®šä¹‰">å®å®šä¹‰</a></li>
        <li><a href="#api-æ‰‹å†Œ" id="toc-api-æ‰‹å†Œ">API æ‰‹å†Œ</a></li>
        <li><a href="#æ•°æ®è¯»å–ä¿®æ”¹"
        id="toc-æ•°æ®è¯»å–ä¿®æ”¹">æ•°æ®è¯»å–ä¿®æ”¹</a>
        <ul>
        <li><a href="#patchbyteworddword"
        id="toc-patchbyteworddword">PatchByte/Word/Dword</a></li>
        <li><a href="#byteworddwordqword"
        id="toc-byteworddwordqword">Byte/Word/Dword/Qword</a></li>
        <li><a href="#isloaded" id="toc-isloaded">isLoaded</a></li>
        </ul></li>
        <li><a href="#ç”¨æˆ·äº¤äº’å‡½æ•°"
        id="toc-ç”¨æˆ·äº¤äº’å‡½æ•°">ç”¨æˆ·äº¤äº’å‡½æ•°</a>
        <ul>
        <li><a href="#message" id="toc-message">Message</a></li>
        <li><a href="#print" id="toc-print">print</a></li>
        <li><a href="#warning" id="toc-warning">warning</a></li>
        <li><a href="#askstr" id="toc-askstr">AskStr</a></li>
        <li><a href="#askfile" id="toc-askfile">AskFile</a></li>
        <li><a href="#askyn" id="toc-askyn">AskYN</a></li>
        <li><a href="#screenea" id="toc-screenea">ScreenEA</a></li>
        <li><a href="#jump" id="toc-jump">Jump</a></li>
        </ul></li>
        <li><a href="#å­—ç¬¦ä¸²æ“ä½œå‡½æ•°"
        id="toc-å­—ç¬¦ä¸²æ“ä½œå‡½æ•°">å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</a>
        <ul>
        <li><a href="#form" id="toc-form">form</a></li>
        <li><a href="#sprintf" id="toc-sprintf">sprintf</a></li>
        <li><a href="#atol" id="toc-atol">atol</a></li>
        <li><a href="#xtol" id="toc-xtol">xtol</a></li>
        <li><a href="#ltoa" id="toc-ltoa">ltoa</a></li>
        <li><a href="#ord" id="toc-ord">ord</a></li>
        <li><a href="#strlen" id="toc-strlen">strlen</a></li>
        <li><a href="#strstr" id="toc-strstr">strstr</a></li>
        <li><a href="#substr" id="toc-substr">substr</a></li>
        </ul></li>
        <li><a href="#æ–‡ä»¶æ“ä½œ" id="toc-æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</a>
        <ul>
        <li><a href="#fopen" id="toc-fopen">fopen</a></li>
        <li><a href="#fclose" id="toc-fclose">fclose</a></li>
        <li><a href="#filelength"
        id="toc-filelength">filelength</a></li>
        <li><a href="#fgetc" id="toc-fgetc">fgetc</a></li>
        <li><a href="#fputc" id="toc-fputc">fputc</a></li>
        <li><a href="#fprintf" id="toc-fprintf">fprintf</a></li>
        <li><a href="#writestr" id="toc-writestr">writestr</a></li>
        <li><a href="#readstr" id="toc-readstr">readstr</a></li>
        <li><a href="#writelong" id="toc-writelong">writelong</a></li>
        <li><a href="#readlong" id="toc-readlong">readlong</a></li>
        <li><a href="#writeshort"
        id="toc-writeshort">writeshort</a></li>
        <li><a href="#readshort" id="toc-readshort">readshort</a></li>
        <li><a href="#loadfile" id="toc-loadfile">loadfile</a></li>
        <li><a href="#savefile" id="toc-savefile">savefile</a></li>
        </ul></li>
        <li><a href="#æ“ä½œæ•°æ®åº“åç§°"
        id="toc-æ“ä½œæ•°æ®åº“åç§°">æ“ä½œæ•°æ®åº“åç§°</a>
        <ul>
        <li><a href="#name" id="toc-name">Name</a></li>
        <li><a href="#nameex" id="toc-nameex">NameEx</a></li>
        <li><a href="#makenameex"
        id="toc-makenameex">MakeNameEx</a></li>
        <li><a href="#locbyname" id="toc-locbyname">LocByName</a></li>
        <li><a href="#locbynameex"
        id="toc-locbynameex">LocByNameEx</a></li>
        </ul></li>
        <li><a href="#æ“ä½œæ•°æ®åº“çš„å‡½æ•°"
        id="toc-æ“ä½œæ•°æ®åº“çš„å‡½æ•°">æ“ä½œæ•°æ®åº“çš„å‡½æ•°</a>
        <ul>
        <li><a href="#makeunkn" id="toc-makeunkn">MakeUnkn</a></li>
        <li><a href="#makecode" id="toc-makecode">MakeCode</a></li>
        <li><a href="#makebyte" id="toc-makebyte">MakeByte</a></li>
        <li><a href="#makecomm" id="toc-makecomm">MakeComm</a></li>
        <li><a href="#makefunction"
        id="toc-makefunction">MakeFunction</a></li>
        <li><a href="#makestr" id="toc-makestr">MakeStr</a></li>
        </ul></li>
        <li><a href="#æ•°æ®åº“æœç´¢å‡½æ•°"
        id="toc-æ•°æ®åº“æœç´¢å‡½æ•°">æ•°æ®åº“æœç´¢å‡½æ•°</a>
        <ul>
        <li><a href="#findcode" id="toc-findcode">FindCode</a></li>
        <li><a href="#finddata" id="toc-finddata">FindData</a></li>
        <li><a href="#findbinary"
        id="toc-findbinary">FindBinary</a></li>
        <li><a href="#findtext" id="toc-findtext">FindText</a></li>
        </ul></li>
        <li><a href="#æ“ä½œå‡½æ•°" id="toc-æ“ä½œå‡½æ•°">æ“ä½œå‡½æ•°</a>
        <ul>
        <li><a href="#getfunctionattr"
        id="toc-getfunctionattr">GetFunctionAttr</a></li>
        <li><a href="#getfunctionname"
        id="toc-getfunctionname">GetFunctionName</a></li>
        <li><a href="#nextfunction"
        id="toc-nextfunction">NextFunction</a></li>
        <li><a href="#prevfunction"
        id="toc-prevfunction">PrevFunction</a></li>
        </ul></li>
        <li><a href="#ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°"
        id="toc-ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°">ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°</a>
        <ul>
        <li><a href="#rfirst" id="toc-rfirst">Rfirst</a></li>
        <li><a href="#rnext" id="toc-rnext">Rnext</a></li>
        <li><a href="#xreftype" id="toc-xreftype">XrefType</a></li>
        <li><a href="#rfirstb" id="toc-rfirstb">RfirstB</a></li>
        <li><a href="#rnextb" id="toc-rnextb">RnextB</a></li>
        </ul></li>
        <li><a href="#æ•°æ®äº¤å‰å¼•ç”¨"
        id="toc-æ•°æ®äº¤å‰å¼•ç”¨">æ•°æ®äº¤å‰å¼•ç”¨</a>
        <ul>
        <li><a href="#dfirst" id="toc-dfirst">Dfirst</a></li>
        <li><a href="#dnext" id="toc-dnext">Dnext</a></li>
        <li><a href="#xreftype-1"
        id="toc-xreftype-1">XrefType()</a></li>
        <li><a href="#dfirstb" id="toc-dfirstb">DfirstB</a></li>
        <li><a href="#dnextb" id="toc-dnextb">DnextB</a></li>
        </ul></li>
        <li><a href="#åæ±‡ç¼–æå–" id="toc-åæ±‡ç¼–æå–">åæ±‡ç¼–æå–</a>
        <ul>
        <li><a href="#getdisasm" id="toc-getdisasm">GetDisasm</a></li>
        <li><a href="#getmnem" id="toc-getmnem">GetMnem</a></li>
        <li><a href="#getopnd" id="toc-getopnd">GetOpnd</a></li>
        <li><a href="#getoptype" id="toc-getoptype">GetOpType</a></li>
        <li><a href="#getoperandvalue"
        id="toc-getoperandvalue">GetOperandValue</a></li>
        <li><a href="#itemsize" id="toc-itemsize">ItemSize</a></li>
        <li><a href="#getregvaluerip"
        id="toc-getregvaluerip">GetRegValue(â€œRIPâ€)</a></li>
        <li><a href="#get_func_name"
        id="toc-get_func_name">get_func_name</a></li>
        </ul></li>
        <li><a href="#misc-func" id="toc-misc-func">misc-func</a></li>
        <li><a href="#é™„å½•" id="toc-é™„å½•">é™„å½•</a></li>
        </ul>

        </div>
      </div>
            <div class="span9">

      
      <h1 id="è¯´æ˜æ–‡æ¡£">è¯´æ˜æ–‡æ¡£</h1>
<p>å­¦ä¹ é“¾æ¥:</p>
<p>[https://blog.csdn.net/weixin_44531336/article/details/125076279](</p>
<h1 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h1>
<p>ğŸ§¡å‚è€ƒé“¾æ¥: lyshark <a
href="https://www.cnblogs.com/LyShark/p/13100048.html">https://www.cnblogs.com/LyShark/p/13100048.html</a></p>
<p><a
href="https://introspelliam.github.io/2017/09/18/tools/IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc/">https://introspelliam.github.io/2017/09/18/tools/IDA%E7%9A%84%E8%B0%83%E8%AF%95%E8%84%9A%E6%9C%ACidc/</a></p>
<p>åœ¨IDAä¸­æŒ‰ä¸‹ã€shift + F2ã€‘å¯è°ƒå‡ºè„šæœ¬ç¼–è¾‘å™¨</p>
<p>å°±IDApythonçš„è¯,æ„Ÿè§‰æ¯”ä»·ç«</p>
<p>ä½†æ˜¯,æˆ‘å–œæ¬¢C,IDCçš„å‚è€ƒæŒ‡ä»¤å¯ä»¥è¯´,å·¨å°‘</p>
<p><a
href="https://www.hex-rays.com/products/ida/support/idadoc/">https://www.hex-rays.com/products/ida/support/idadoc/</a></p>
<h1 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</h1>
<p>ä»–ä»¬çš„æ•°å€¼æ¯”è¾ƒéƒ½æ˜¯æœ‰ç¬¦å·çš„,ä¸”ä¸€èˆ¬ä¸º4å­—èŠ‚æ¯”è¾ƒ(çŒœæµ‹çš„)</p>
<p>æ— ç¬¦å·æ¯”è¾ƒéœ€è¦å»é™¤ç¬¦å·ä½,æ¯”å¦‚&amp;0xffçš„Byte</p>
<p>x86çš„IDC,,,0xffffffff==-1,ä½†æ˜¯0xffffffffffffffffâ‰ -1</p>
<p>IDCä¸­æ‰€æœ‰å˜é‡éƒ½è¢«å®šä¹‰æˆautoç±»å‹ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¸€èˆ¬ç±»å‹æœ‰æ•´æ•°å‹ã€å­—ç¬¦ä¸²ç±»å‹ã€æµ®ç‚¹å‹</p>
<p>å˜é‡åœ¨æ²¡æœ‰èµ‹äºˆåˆå§‹å€¼çš„æƒ…å†µä¸‹,ä¸º0</p>
<ul>
<li>å±€éƒ¨å˜é‡ï¼šauto counter;</li>
<li>extern å¼•å…¥å…¨å±€å˜é‡çš„å£°æ˜ï¼Œextern outsideGlobal;</li>
<li>å­—ç¬¦ä¸²æ”¯æŒåŠ å¥½è¿æ¥ï¼šauto str = â€œhelloâ€ + â€œworldâ€;</li>
<li>å­—ç¬¦ä¸²æ”¯æŒåˆ†ç‰‡æ“ä½œï¼šstr1 = str[7:9];</li>
<li>æ²¡æœ‰strcatâ€¦ç­‰ç­‰å‡½æ•°</li>
</ul>
<pre><code>auto addr, reg, val;    //æ²¡æœ‰åˆå§‹åŒ–å£°æ˜çš„å¤šä¸ªå˜é‡
auto count = 0;         //å·²å£°æ˜å’Œåˆå§‹åŒ–</code></pre>
<pre><code>extern outsideGlobal;

static main()
{
    extern insideGlobal;
    outsideGlobal = &quot;Global&quot;;
    insideGlobal = 1;
}</code></pre>
<p>è™½ç„¶IDCæ²¡æœ‰æ•°ç»„æ•°æ®ç±»å‹,ä½†ä½ å¯ä»¥ä½¿ç”¨åˆ†ç‰‡è¿ç®—ç¬¦æ¥å¤„ç†IDCå­—ç¬¦ä¸²,</p>
<p>å°±å¥½åƒä»–ä»¬æ˜¯æ•°ç»„ä¸€æ ·,IDCåˆ†ç‰‡çš„ç”¨æ³•ï¼š</p>
<pre><code>auto str = &quot;String to slice&quot;;
auto s1, s2, s3, s4;
s1 = str[7:9];          //&#39;to&#39;
s2 = str[ :6];         //&#39;String&#39;
s3 = str[10: ];        //&#39;slice&#39;
s4 = str[5];               //&#39;g&#39;</code></pre>
<h1 id="å­—ç¬¦ä¸²æ“ä½œ">å­—ç¬¦ä¸²æ“ä½œ</h1>
<pre><code>if ( op == &quot;jmp&quot; || op == &quot;call&quot; )
{
...
}</code></pre>
<pre><code>#include &lt;idc.idc&gt;

static main()
{
    // æ ¼å¼åŒ–å­—ç¬¦ä¸²,ç±»ä¼¼äºsprintf
    auto name = form(&quot;hello %s&quot;,&quot;lyshark&quot;);
    Message(&quot;æ ¼å¼åŒ–åçš„å†…å®¹: %s \n&quot;,name);

    Message(&quot;åå…­è¿›åˆ¶è½¬ä¸ºæ•´æ•°: %d \n&quot;,xtol(&quot;0x41&quot;));
    Message(&quot;åè¿›åˆ¶100è½¬ä¸ºå…«è¿›åˆ¶: %d \n&quot;,ltoa(100,8));
    Message(&quot;åè¿›åˆ¶100è½¬æ¢äºŒè¿›åˆ¶: %d \n&quot;,ltoa(100,2));
    Message(&quot;å­—ç¬¦Açš„ASCII: %d \n&quot;,ord(&quot;A&quot;));
    Message(&quot;è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦: %d \n&quot;,strlen(&quot;hello lyshark&quot;));

    // åœ¨è‘—å­—ç¬¦ä¸²ä¸­å¯»æ‰¾å­ä¸²
    auto main = &quot;hello lyshark&quot;;
    auto sub = &quot;lyshark&quot;;
    Message(&quot;å¯»æ‰¾å­ä¸²: %d \n&quot;,strstr(main,sub));
}</code></pre>
<h1 id="æ•°ç»„">æ•°ç»„</h1>
<p>ä¸€ä¸ªä¾‹å­å°±å¯ä»¥ææ‡‚</p>
<pre><code>#include &lt;idc.idc&gt;

static main()
{
    // åˆ›å»ºæ•°ç»„å…ƒç´ 
    auto ObjArr = CreateArray(&quot;array&quot;);
    // è·å–æ•°ç»„æŒ‡é’ˆ
    auto lp_Arr = GetArrayId(&quot;array&quot;);

    Message(&quot;Arr: %X\n&quot;, lp_Arr);

    // è®¾ç½®ä¸¤ä¸ªå­—ç¬¦ä¸²å˜é‡
    SetArrayString(lp_Arr, 0, &quot;hello&quot;);
    SetArrayString(lp_Arr, 1, &quot;re4mile&quot;);

    // è®¾ç½®ä¸¤ä¸ªæ•´æ•°å˜é‡
    SetArrayLong(lp_Arr, 2, 100);
    SetArrayLong(lp_Arr, 3, 200);

    // å¦‚æœæå–å­—ç¬¦ä¸²ä½¿ç”¨ AR_STR æ ‡è®° ï¼Œæå–æ•´æ•°ä½¿ç”¨ AR_LONG
    auto sz1 = GetArrayElement(AR_STR, lp_Arr, 0);
    auto sz2 = GetArrayElement(AR_STR, lp_Arr, 1);
    Message(&quot;å­—ç¬¦ä¸²: %s %s !\n&quot;, sz1, sz2);

    auto num1 = GetArrayElement(AR_LONG, lp_Arr, 2);
    auto num2 = GetArrayElement(AR_LONG, lp_Arr, 3);
    Message(&quot;æ•´æ•°: %d %d\n&quot;, num1,num2);

    // åˆ é™¤æ•°ç»„çš„0å·å…ƒç´ 
    DelArrayElement(AR_STR, lp_Arr, 0);
    // æ³¨é”€æ•´ä¸ªæ•°ç»„
    DeleteArray(lp_Arr);
}</code></pre>
<h1 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦</h1>
<p>è®¸å¤šæ ‡å‡†çš„Cè¯­è¨€æ“ä½œç¬¦ï¼ˆ+ã€-ã€*ã€/ã€%ã€&lt;&lt;ã€&gt;&gt;ã€++ã€â€“ï¼‰åŒ…æ‹¬ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆ?:)</p>
<p>åœ¨IDCåŒæ ·é€‚ç”¨ï¼Œä½†å¤åˆèµ‹å€¼è¿ç®—ç¬¦+=ä¸æ”¯æŒã€é€—å·æ“ä½œç¬¦ä¹Ÿä¸è¢«æ”¯æŒã€‚</p>
<p>IDCå‡ ä¹æ”¯æŒCä¸­çš„æ‰€æœ‰è¿ç®—å’Œé€»è¾‘æ“ä½œç¬¦ï¼Œä½†æ˜¯æ‰€æœ‰æ•´æ•°æ“ä½œæ•°å‡ä½œä¸ºæœ‰ç¬¦å·çš„å€¼å¤„ç†ã€‚</p>
<p>è¿™ä¼šå½±å“åˆ°æ•´æ•°æ¯”è¾ƒä¸å³ç§»ä½è¿ç®—ã€‚å¦‚æœéœ€è¦è¿›è¡Œé€»è¾‘å³ç§»ä½è¿ç®—ï¼Œä½ å¿…é¡»ä¿®æ”¹ç»“æœçš„æœ€é«˜ä½ï¼Œè‡ªå·±ç§»ä½ï¼Œ</p>
<p>å¦‚ä¸‹ä»£ç ï¼š</p>
<p>result = ( x &gt;&gt; 1 ) &amp; 0x7fffffff; //å°†æœ€å¤§æœ‰æ•ˆä½è®¾ç½®ä¸º0</p>
<p>ä¸Cè¯­è¨€ä¸€æ ·ï¼ŒIDCæ‰€æœ‰ç®€å•è¯­å¥å‡ä»¥åˆ†å·ç»“æŸã€‚</p>
<p>Switchè¯­å¥æ˜¯IDCå”¯ä¸€ä¸æ”¯æŒçš„Cé£æ ¼å¤åˆè¯­å¥ã€‚</p>
<p>åœ¨ä½¿ç”¨forè¯­å¥æ—¶IDCä¸æ”¯æŒå¤åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚æœä½ å¸Œæœ›ä»¥é™¤1ä»¥å¤–çš„å…¶ä»–å€¼ä¸ºå•ä½è¿›è¡Œè®¡æ•°ï¼Œå°±éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹ï¼Œ</p>
<p>å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code>auto i;
for (i = 0; i &lt; 10; i += 2)
{

}       //ä¸åˆæ³•ï¼Œä¸æ”¯æŒ +=
for (i = 0; i &lt; 10; i = i + 2)
{

}    //åˆæ³•</code></pre>
<h1 id="å‡½æ•°å®šä¹‰">å‡½æ•°å®šä¹‰</h1>
<p>å®šä¹‰ä¸€ä¸ªå‡½æ•°</p>
<pre><code>#include &lt; idc&gt;

// å®šä¹‰ä¸€ä¸ªå‡½æ•°
static OutPutAddress(My)
{
    auto tmp;
    tmp = 0x1300 + My;
    return tmp;
}

static main()
{
    auto ret = OutPutAddress(0x14);
    Message(&quot;%x \n&quot;,ret);
}</code></pre>
<h1 id="å®å®šä¹‰">å®å®šä¹‰</h1>
<p>BADADDR = -1</p>
<h1 id="api-æ‰‹å†Œ">API æ‰‹å†Œ</h1>
<p><a
href="https://www.hex-rays.com/products/ida/support/idadoc/162.shtml">https://www.hex-rays.com/products/ida/support/idadoc/162.shtml</a></p>
<p>å…¶å®å°±æ˜¯</p>
<figure>
<img
src="%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3%2000f0fc98b7e949fbbbc0a3f932629dde/Untitled.png"
alt="Untitled" />
<figcaption aria-hidden="true">Untitled</figcaption>
</figure>
<p>jmp åˆ°å½“å‰ä½ç½®+1</p>
<pre><code>EB FF           jmp     short near ptr loc_1144+1
-------------------------------------------------------------
                dw 0BFC0h
                dq 0FFFEDFE800000068h, 65BFC0FFEBFFh, 0FFEBFFFFFED2E800h
                dq 0C5E80000006CBFC0h, 6CBFC0FFEBFFFFFEh, 0FFFFFEB8E8000000h
                dq 6FBFC0FFEBh, 0C0FFEBFFFFFEABE8h, 0FE9EE800000020BFh
                dq 77BFC0FFEBFFFFh, 0EBFFFFFE91E80000h, 0E80000006FBFC0FFh</code></pre>
<p>ä»–çš„ç‰¹å¾ä»£ç æ˜¯EB FF</p>
<p>EBæ˜¯jmp FFæ˜¯åç§»</p>
<p>äºæ˜¯è¿™ç§æ²¡æœ‰æ„ä¹‰çš„è·³è½¬åº”è¯¥ç»™nopæ‰</p>
<pre><code>EB                                      db 0EBh
;---------------------------------------------------------------------------
FF C0                                   inc     eax
BF 68 00 00 00                          mov     edi, 68h ; &#39;h&#39;
E8 DF FE FF FF                          call    _putchar</code></pre>
<p>å¦‚æœç¨‹åºä¸­æœ‰å¤§é‡çš„è¿™ç§èŠ±æŒ‡ä»¤.é‚£ä¹ˆä½ ä¸å¯èƒ½æ‰‹åŠ¨çš„ä¸€ä¸ªä¸€ä¸ªå»nopæ‰</p>
<p>ç”¨è„šæœ¬</p>
<pre><code>#include &lt; idc&gt;
static main()
{
    auto x, target_str, ProcRange;
    target_str = &quot;EB FF C0 BF&quot;;
    for (x = FindBinary(MinEA(), 0x03, target_str); x != BADADDR; x = FindBinary(x, 0x03, target_str))
    {
        PatchByte(x, 0x90);
    }
}</code></pre>
<p>FindBinary(MinEA(), 0x03, target_str)çš„æ„æ€æ˜¯?</p>
<p>ä»åœ°å€MinEA()å¤„æŒ‰0x03çš„æ¨¡å¼éå†å­—èŠ‚ç target_str</p>
<p>MinEA()æ˜¯æœ€å°çš„åœ°å€</p>
<p>PatchByte(x, 0x90);æ˜¯æŠŠxæŒ‡å‘çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ç»™nopæ‰</p>
<h1 id="æ•°æ®è¯»å–ä¿®æ”¹">æ•°æ®è¯»å–ä¿®æ”¹</h1>
<h3 id="patchbyteworddword">PatchByte/Word/Dword</h3>
<p>void PatchByte(long addr , long val)</p>
<p>è®¾ç½®è™šæ‹Ÿåœ°å€addrå¤„çš„ä¸€ä¸ªå­—èŠ‚å€¼ï¼Œ</p>
<p>PatchByteå¯æ›´æ¢ä¸º</p>
<p>PatchWordï¼ŒPatchDword</p>
<p>è®¾ç½®è™šæ‹Ÿåœ°å€addrå¤„çš„2å­—èŠ‚å’Œ4å­—èŠ‚å€¼ã€‚</p>
<h3 id="byteworddwordqword">Byte/Word/Dword/Qword</h3>
<p>long Byte( long addr)ï¼Œä»è™šæ‹Ÿåœ°å€ addrå¤„è¯»å–ä¸€ä¸ªå­—èŠ‚å€¼ã€‚</p>
<p>long word(long addr)ï¼Œä»è™šæ‹Ÿåœ°å€addrå¤„è¯»å–ä¸€ä¸ªå­—ï¼ˆ2å­—èŠ‚ï¼‰å€¼ã€‚</p>
<p>1ong Dword(long addr)ï¼Œä»è™šæ‹Ÿåœ°å€addrå¤„è¯»å–ä¸€ä¸ªåŒå­—ï¼ˆ4å­—èŠ‚)å€¼ã€‚</p>
<h3 id="isloaded">isLoaded</h3>
<p>boo1 isLoaded(long
addr)ï¼Œå¦‚æœaddråŒ…å«æœ‰æ•ˆæ•°æ®ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</p>
<p>5ï¼‰long atolï¼ˆstring valï¼‰ï¼Œå°†10è¿›åˆ¶valè½¬åŒ–æˆå¯¹åº”æ•´æ•°å€¼ã€‚</p>
<p>6ï¼‰long xtolï¼ˆstring valï¼‰ï¼Œå°†16è¿›åˆ¶valè½¬åŒ–æˆå¯¹åº”æ•´æ•°å€¼ã€‚</p>
<p>7ï¼‰long ordï¼ˆstring chï¼‰ï¼Œè¿”å›å•å­—ç¬¦å­—ç¬¦ä¸²chçš„ASCIIå€¼ã€‚</p>
<p>8ï¼‰string Nameï¼ˆlong
addrï¼‰ï¼Œè¿”å›ä¸ç»™å®šåœ°å€æœ‰å…³çš„åç§°ï¼Œå¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<h1 id="ç”¨æˆ·äº¤äº’å‡½æ•°">ç”¨æˆ·äº¤äº’å‡½æ•°</h1>
<h3 id="message">Message</h3>
<p>void Message(string formatâ€¦.)ï¼Œ</p>
<p>åœ¨è¾“å‡ºçª—å£æ‰“å°ä¸€æ¡æ ¼å¼åŒ–æ¶ˆæ¯ã€‚è¿™ä¸ªå‡½æ•°ç±»ä¼¼äºCè¯­è¨€çš„printfå‡½æ•°ï¼Œå¹¶æ¥å—printfé£æ ¼çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</p>
<h3 id="print">print</h3>
<p>void print( . ..)ï¼Œ</p>
<p>åœ¨è¾“å‡ºçª—å£ä¸­æ‰“å°æ¯ä¸ªå‚æ•°çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚</p>
<h3 id="warning">warning</h3>
<p>void warning(string format. â€¦)ï¼Œ</p>
<p>åœ¨å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºä¸€æ¡æ ¼å¼åŒ–æ¶ˆæ¯ã€‚</p>
<h3 id="askstr">AskStr</h3>
<p>string AskStr(string default, string prompt)ï¼Œ</p>
<p>æ˜¾ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›ç”¨æˆ·çš„å­—ç¬¦ä¸²;</p>
<p>å¦‚æœå¯¹è¯æ¡†è¢«å–æ¶ˆï¼Œåˆ™è¿”å›0ã€‚</p>
<h3 id="askfile">AskFile</h3>
<p>string AskFile(1ong doSaveï¼Œstring mask,string prompt)ï¼Œ</p>
<p>æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œä»¥ç®€åŒ–é€‰æ‹©æ–‡ä»¶çš„ä»»åŠ¡ã€‚</p>
<p>ä½ å¯ä»¥åˆ›å»ºæ–°æ–‡ä»¶ä¿å­˜æ•°æ®( doSave=1)ï¼Œæˆ–é€‰æ‹©ç°æœ‰çš„æ–‡ä»¶è¯»å–æ•°æ®ï¼ˆ
doSave=0)ã€‚</p>
<p>ä½ å¯ä»¥æ ¹æ®mask ï¼ˆå¦‚* .<em>æˆ–</em>. idc)è¿‡æ»¤æ˜¾ç¤ºçš„æ–‡ä»¶åˆ—è¡¨ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›é€‰å®šæ–‡ä»¶çš„åç§°;</p>
<p>å¦‚æœå¯¹è¯æ¡†è¢«å–æ¶ˆ,åˆ™è¿”å›Oã€‚</p>
<h3 id="askyn">AskYN</h3>
<p>long AskYN( long default, string prompt)ï¼Œ</p>
<p>ç”¨ä¸€ä¸ªç­”æ¡ˆä¸ºâ€œæ˜¯â€æˆ–â€œå¦â€çš„é—®é¢˜æç¤ºç”¨æˆ·ï¼Œ</p>
<p>çªå‡ºä¸€ä¸ªé»˜è®¤çš„ç­”æ¡ˆ(1ä¸ºæ˜¯ï¼Œ0ä¸ºå¦ï¼Œ-1ä¸ºå–æ¶ˆ)ã€‚</p>
<p>è¿”å›å€¼æ˜¯ä¸€ä¸ªè¡¨ç¤ºé€‰å®šç­”æ¡ˆçš„æ•´æ•°ã€‚</p>
<h3 id="screenea">ScreenEA</h3>
<p>long ScreenEA(),</p>
<p>è¿”å›å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®çš„è™šæ‹Ÿåœ°å€</p>
<pre><code>#include &lt; idc&gt;

static main()
{
    auto CurrAddress = ScreenEA();
    //ScreenEA() è¿”å›å½“å‰å…‰æ ‡æ‰€åœ¨çš„è™šæ‹Ÿåœ°å€
     Message(&quot;ç¨‹åºOEP =&gt; 0x%x \n&quot;,CurrAddress);
}</code></pre>
<h3 id="jump">Jump</h3>
<p>boo1 Jump( 1ong addr)ï¼Œè·³è½¬åˆ°åæ±‡ç¼–çª—å£çš„æŒ‡å®šåœ°å€ã€‚</p>
<p>å› ä¸ºIDCæ²¡æœ‰ä»»ä½•è°ƒè¯•å·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦å°†Message
å‡½æ•°ä½œä¸ºä½ çš„ä¸»è¦è°ƒè¯•å·¥å…·ã€‚</p>
<p>å…¶ä»–å‡ ä¸ªAskXXXå‡½æ•°ç”¨äºå¤„ç†æ›´åŠ ä¸“ç”¨çš„è¾“äººï¼Œå¦‚æ•´æ•°è¾“äººã€‚è¯·å‚è€ƒå¸®åŠ©ç³»ç»Ÿæ–‡æ¡£äº†è§£å¯ç”¨çš„
AskXXXå‡½æ•°çš„å®Œæ•´åˆ—è¡¨ã€‚</p>
<p>å¦‚æœå¸Œæœ›åˆ›å»ºä¸€ä¸ªæ ¹æ®å…‰æ ‡ä½ç½®è°ƒæ•´å…¶è¡Œä¸ºçš„è„šæœ¬ï¼Œè¿™æ—¶ï¼ŒScreenEAå‡½æ•°å°±éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯ä»¥é€šè¿‡å®ƒç¡®å®šå…‰æ ‡çš„å½“å‰ä½ç½®ã€‚</p>
<p>åŒæ ·ï¼Œå¦‚æœä½ çš„è„šæœ¬éœ€è¦å°†ç”¨æˆ·çš„æ³¨æ„åŠ›è½¬ç§»åˆ°åæ±‡ç¼–ä»£ç æ¸…å•ä¸­çš„æŸä¸ªä½ç½®ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°Jumpå‡½æ•°ã€‚</p>
<h1 id="å­—ç¬¦ä¸²æ“ä½œå‡½æ•°">å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</h1>
<h3 id="form">form</h3>
<p>string form(string formatï¼Œâ€¦)</p>
<p>//preIDA5.6ï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æ ¹æ®æ‰€æä¾›çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å’Œå€¼è¿›è¡Œæ ¼å¼åŒ–ã€‚è¿™ä¸ªå‡½æ•°åŸºæœ¬ä¸Šç­‰åŒäºCè¯­è¨€çš„sprintfå‡½æ•°</p>
<h3 id="sprintf">sprintf</h3>
<p>string sprintf(string format . . . .)</p>
<p>//IDA5.6+ï¼Œåœ¨ IDA5.6ä¸­ï¼Œsprintfç”¨äºæ›¿ä»£form(å‚è§ä¸Šé¢)ã€‚</p>
<h3 id="atol">atol</h3>
<p>1ong ato1(string va1)ï¼Œå°†åè¿›åˆ¶å€¼va1è½¬æ¢æˆå¯¹åº”çš„æ•´æ•°å€¼ã€‚</p>
<h3 id="xtol">xtol</h3>
<p>1ong xtol(string
val)ï¼Œå°†åå…­è¿›åˆ¶å€¼val(å¯é€‰æ‹©ä»¥0xå¼€å¤´ï¼‰è½¬æ¢æˆå¯¹åº”çš„æ•´æ•°å€¼ã€‚</p>
<p>Message(â€œåå…­è¿›åˆ¶è½¬ä¸ºæ•´æ•°: %d â€,xtol(â€œ0x41â€))</p>
<h3 id="ltoa">ltoa</h3>
<p>string ltoa(1ong va1ï¼Œ1ong radix)ï¼Œ</p>
<p>ä»¥æŒ‡å®šçš„radix (2ã€8ã€10æˆ–16)è¿”å›va1çš„å­—ç¬¦ä¸²å€¼ã€‚</p>
<p>Message(â€œåè¿›åˆ¶100è½¬ä¸ºå…«è¿›åˆ¶: %d â€,ltoa(100,8));</p>
<h3 id="ord">ord</h3>
<p>long ord(string ch)ï¼Œè¿”å›å•å­—ç¬¦å­—ç¬¦ä¸²ch çš„ASCIå€¼ã€‚</p>
<p>Message(â€œå­—ç¬¦Açš„ASCII: %d â€,ord(â€œAâ€));</p>
<h3 id="strlen">strlen</h3>
<p>long strlen(string str)ï¼Œè¿”å›æ‰€æä¾›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<p>Message(â€œè®¡ç®—å­—ç¬¦ä¸²é•¿åº¦: %d â€,strlen(â€œhello re4mileâ€));</p>
<h3 id="strstr">strstr</h3>
<p>long strstr(string str. string substr)ï¼Œ</p>
<p>è¿”å›strä¸­ substr çš„ç´¢å¼•ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å‘ç°å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›-1ã€‚</p>
<p>ç±»ä¼¼äºpythonçš„è¯­æ³• if â€œdqxâ€ in â€œI am dqxâ€</p>
<pre><code>if(strstr(op,&quot;push    esi&quot;)==0)
{
    ...
    }
å…¶å®ä»–å°±æ˜¯ä¸€ä¸ªstrcmpçš„ä½œç”¨,å¦‚æœè¿”å›0,è¯´æ˜å­—ç¬¦ä¸²åˆšå¥½åŒ¹é…</code></pre>
<h3 id="substr">substr</h3>
<p>string substr(string str. long start.1ong end)ï¼Œ</p>
<p>è¿”å›åŒ…å« str ä¸­ç”±startåˆ°end-1ä½ç½®çš„å­—ç¬¦çš„å­å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœä½¿ç”¨åˆ†ç‰‡ï¼ˆIDA5.6åŠæ›´é«˜ç‰ˆæœ¬)ï¼Œæ­¤å‡½æ•°ç­‰åŒäºstr[start:end]ã€‚å¦‚å‰æ‰€è¿°ï¼ŒIDCä¸­æ²¡æœ‰ä»»ä½•å­—ç¬¦æ•°æ®ç±»å‹ï¼Œå®ƒä¹Ÿä¸æ”¯æŒä»»ä½•æ•°ç»„è¯­æ³•ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦éå†å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œå¿…é¡»æŠŠå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦å½“æˆè¿ç»­çš„å•å­—ç¬¦å­å­—ç¬¦ä¸²å¤„ç†ã€‚</p>
<h1 id="æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</h1>
<p>è¾“å‡ºçª—å£å¹¶ä¸æ€»æ˜¯æ˜¾ç¤ºè„šæœ¬è¾“å‡ºçš„ç†æƒ³ä½ç½®</p>
<p>å¯¹äºç”Ÿæˆå¤§é‡æ–‡æœ¬æˆ–äºŒè¿›åˆ¶æ•°æ®çš„è„šæœ¬ï¼Œä½ å¯èƒ½å¸Œæœ›å°†å…¶ç»“æœè¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶ä¸Šã€‚</p>
<p>æˆ‘ä»¬å·²ç»è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨AskFi1eå‡½æ•°è¦æ±‚ç”¨æˆ·è¾“å…¥æ–‡ä»¶åã€‚</p>
<p>ä½†æ˜¯ï¼ŒAskFi1eä»…è¿”å›ä¸€ä¸ªåŒ…å«æ–‡ä»¶åçš„å­—ç¬¦ä¸²å€¼ã€‚</p>
<p>IDCçš„æ–‡ä»¶å¤„ç†å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="fopen">fopen</h3>
<p>long fopen(string filenameï¼Œstring mode)</p>
<p>è¿”å›ä¸€ä¸ªæ•´æ•°æ–‡ä»¶å¥æŸ„ï¼ˆå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›0)</p>
<p>ä¾›æ‰€æœ‰IDCæ–‡ä»¶è¾“å…¥/è¾“å‡ºå‡½æ•°ä½¿ç”¨</p>
<p>modeå‚æ•°ä¸Cè¯­è¨€çš„fopen å‡½æ•°ä½¿ç”¨çš„æ¨¡å¼(
rè¡¨ç¤ºè¯»å–ï¼Œwè¡¨ç¤ºå†™å…¥ï¼Œç­‰ç­‰ï¼‰ç±»ä¼¼</p>
<h3 id="fclose">fclose</h3>
<p>void fclose(long hand1e)</p>
<p>å…³é—­fopenä¸­æ–‡ä»¶å¥æŸ„æŒ‡å®šçš„æ–‡ä»¶ã€‚</p>
<h3 id="filelength">filelength</h3>
<p>long filelength(long handle)</p>
<p>è¿”å›æŒ‡å®šæ–‡ä»¶çš„é•¿åº¦ï¼Œ</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fgetc">fgetc</h3>
<p>1ong fgetc(long handle)ï¼Œä»ç»™å®šæ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fputc">fputc</h3>
<p>long fputc(long val. long handle)ï¼Œå†™å…¥ä¸€ä¸ªå­—èŠ‚åˆ°ç»™å®šæ–‡ä»¶ä¸­</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›0;</p>
<p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="fprintf">fprintf</h3>
<p>long fprintf(1ong handle, string formatï¼Œâ€¦)</p>
<p>å°†ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ä¸­ã€‚</p>
<h3 id="writestr">writestr</h3>
<p>long writestr(long handle. string
str)ï¼Œå°†æŒ‡å®šçš„å­—ç¬¦ä¸²å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ä¸­ã€‚</p>
<h3 id="readstr">readstr</h3>
<p>string/long readstr(1ong handle)ï¼Œä»ç»™å®šæ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p>è¿™ä¸ªå‡½æ•°è¯»å–åˆ°ä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¸ºæ­¢çš„æ‰€æœ‰å­—ç¬¦ï¼ˆåŒ…æ‹¬éASCIIå­—ç¬¦)ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦æœ¬èº«(ASCII
OxA )ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²;</p>
<p>å¦‚æœè¯»å–åˆ°æ–‡ä»¶ç»“å°¾ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="writelong">writelong</h3>
<p>long writelong(long handle. long va1ï¼Œ long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian-1)æˆ–å°ç«¯(
bigendian=0)å­—èŠ‚é¡ºåºå°†ä¸€ä¸ª4å­—èŠ‚æ•´æ•°å†™å…¥åˆ°ç»™å®šæ–‡ä»¶ã€‚</p>
<h3 id="readlong">readlong</h3>
<p>long readlong( long handle,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian=1)</p>
<p>æˆ–å°ç«¯( bigendian=-Q)å­—èŠ‚é¡ºåºä»ç»™å®šçš„æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ª4å­—èŠ‚æ•´æ•°ã€‚</p>
<h3 id="writeshort">writeshort</h3>
<p>long writeshort(long handleï¼Œlong va1,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯( bigendian=1)æˆ–å°ç«¯(
bigendian=0)å­—èŠ‚é¡ºåºå°†ä¸€ä¸ª2å­—èŠ‚æ•´æ•°å†™å…¥åˆ°ç»™å®šçš„æ–‡ä»¶ã€‚</p>
<h3 id="readshort">readshort</h3>
<p>long readshort( 1ong handle,long bigendian)</p>
<p>ä½¿ç”¨å¤§ç«¯(bigendian-1)æˆ–å°ç«¯(
bigendian=0)å­—èŠ‚é¡ºåºä»ç»™å®šçš„æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ª2å­—èŠ‚æ•´æ•°ã€‚</p>
<h3 id="loadfile">loadfile</h3>
<p>bool loadfile(long handle ,long posï¼Œlong addr. long length)</p>
<p>ä»ç»™å®šæ–‡ä»¶çš„posä½ç½®è¯»å–lengthæ•°é‡çš„å­—èŠ‚ï¼Œå¹¶å°†è¿™äº›å­—èŠ‚å†™å…¥åˆ°ä»¥addråœ°å€å¼€å¤´çš„æ•°æ®åº“ä¸­ã€‚</p>
<h3 id="savefile">savefile</h3>
<p>bool savefile(long handleï¼Œ1ong pos., long addr. long length)</p>
<p>å°†ä»¥addræ•°æ®åº“åœ°å€å¼€å¤´çš„lengthæ•°é‡çš„å­—èŠ‚å†™å…¥ç»™å®šæ–‡ä»¶çš„posä½ç½®ã€‚</p>
<p>eg</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;idc.idc&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> getFuncName<span class="op">(</span>ea<span class="op">)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> funcName <span class="op">=</span> get_func_name<span class="op">(</span>ea<span class="op">);</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> dm <span class="op">=</span> demangle_name<span class="op">(</span>funcName<span class="op">,</span> get_inf_attr<span class="op">(</span>INF_LONG_DN<span class="op">));</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dm <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        funcName <span class="op">=</span> dm<span class="op">;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> funcName<span class="op">;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> functionDump<span class="op">(</span>ip_CurFuncStart<span class="op">)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> funcName <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ip_CurFuncEnd <span class="op">=</span> <span class="bn">0x0</span><span class="op">;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> ip_NextFuncStart<span class="op">;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> sz_FileName <span class="op">=</span> get_idb_path<span class="op">()[</span><span class="dv">0</span><span class="op">:-</span><span class="dv">4</span><span class="op">]</span> <span class="op">+</span> <span class="st">&quot;_dump.txt&quot;</span><span class="op">;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> fp <span class="op">=</span> fopen<span class="op">(</span>sz_FileName<span class="op">,</span> <span class="st">&quot;w&quot;</span><span class="op">);</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> appendData <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ip_CurFuncStart <span class="op">!=</span> BADADDR<span class="op">)</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        ip_CurFuncStart     <span class="op">=</span> NextFunction<span class="op">(</span>ip_CurFuncStart<span class="op">);</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>        ip_CurFuncEnd       <span class="op">=</span> FindFuncEnd<span class="op">(</span>ip_CurFuncStart<span class="op">);</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        ip_NextFuncStart    <span class="op">=</span> NextFunction<span class="op">(</span>ip_CurFuncStart<span class="op">);</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>        funcName            <span class="op">=</span> getFuncName<span class="op">(</span>ip_CurFuncStart<span class="op">);</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>ip_NextFuncStart <span class="op">==</span> BADADDR<span class="op">)</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>            fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot;0x</span><span class="sc">%08X</span><span class="st"> --&gt; 0x</span><span class="sc">%08X</span><span class="st"> </span><span class="sc">%s\n</span><span class="st">&quot;</span><span class="op">,</span> ip_CurFuncStart<span class="op">,</span> ip_CurFuncEnd<span class="op">,</span> funcName<span class="op">);</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>            ip_CurFuncStart <span class="op">=</span> ip_NextFuncStart<span class="op">;</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        appendData <span class="op">=</span> ip_NextFuncStart <span class="op">-</span> ip_CurFuncEnd<span class="op">;</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>       <span class="co">// ip_CurFuncEnd = ip_NextFuncStart - 1;//ä»–ä»¬ä¹‹é—´çš„å·®åˆ«ä¸ä»…ä»…æ˜¯1,å› ä¸ºä¼šæœ‰å­—èŠ‚çš„å¡«å……</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        fprintf<span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot;0x</span><span class="sc">%08X</span><span class="st"> --&gt; 0x</span><span class="sc">%08X</span><span class="st"> + 0x</span><span class="sc">%08X</span><span class="st"> </span><span class="sc">%s\n</span><span class="st">&quot;</span><span class="op">,</span> ip_CurFuncStart<span class="op">,</span> ip_CurFuncEnd<span class="op">,</span> appendData<span class="op">,</span>funcName<span class="op">);</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    fclose<span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> main<span class="op">()</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    Message<span class="op">(</span><span class="st">&quot;Start</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    functionDump<span class="op">(</span><span class="bn">0x00040000</span><span class="op">);</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    Message<span class="op">(</span><span class="st">&quot;End</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="æ“ä½œæ•°æ®åº“åç§°">æ“ä½œæ•°æ®åº“åç§°</h1>
<p>åœ¨è„šæœ¬ä¸­ï¼Œä½ ç»å¸¸éœ€è¦æ“çºµå·²å‘½åçš„ä½ç½®ã€‚ä¸‹é¢çš„IDCå‡½æ•°ç”¨äºå¤„ç†IDAæ•°æ®åº“ä¸­å·²å‘½åçš„ä½ç½®ã€‚</p>
<h3 id="name">Name</h3>
<p>string Name(1ong addr)ï¼Œ</p>
<p>è¿”å›ä¸ç»™å®šåœ°å€æœ‰å…³çš„åç§°ï¼Œ</p>
<p>å¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœåç§°è¢«æ ‡è®°ä¸ºå±€éƒ¨åç§°ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸è¿”å›ç”¨æˆ·å®šä¹‰çš„åç§°ã€‚</p>
<h3 id="nameex">NameEx</h3>
<p>string NameEx(long fromï¼Œlong
addr)ï¼Œè¿”å›ä¸addræœ‰å…³çš„åç§°ã€‚å¦‚æœè¯¥ä½ç½®æ²¡æœ‰åç§°ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœ
fromæ˜¯ä¸€ä¸ªåŒæ ·åŒ…å«addrçš„å‡½æ•°ä¸­çš„åœ°å€ï¼Œåˆ™è¿™ä¸ªå‡½æ•°è¿”å›ç”¨æˆ·å®šä¹‰çš„å±€éƒ¨åç§°ã€‚</p>
<h3 id="makenameex">MakeNameEx</h3>
<p>bool MakeNameEx(1ong addr. string name. long flags)ï¼Œ</p>
<p>å°†ç»™å®šçš„åç§°åˆ†é…ç»™ç»™å®šçš„åœ°å€ã€‚è¯¥åç§°ä½¿ç”¨flagsä½æ©ç ä¸­æŒ‡å®šçš„å±æ€§åˆ›å»ºè€Œæˆã€‚</p>
<p>è¿™äº›æ ‡å¿—åœ¨å¸®åŠ©ç³»ç»Ÿä¸­çš„MakeNameExæ–‡æ¡£ä¸­æœ‰è®°è½½æè¿°ï¼Œ</p>
<p>å¯ç”¨äºæŒ‡å®šå„ç§å±æ€§ï¼Œå¦‚åç§°æ˜¯å±€éƒ¨åç§°è¿˜æ˜¯å…¬å…±åç§°ã€åç§°æ˜¯å¦åº”åœ¨åç§°çª—å£ä¸­åˆ—å‡º</p>
<h3 id="locbyname">LocByName</h3>
<p>long LocByName(string
name)ï¼Œè¿”å›ä¸€ä¸ªä½ç½®ï¼ˆåç§°å·²ç»™å®šï¼‰çš„åœ°å€ã€‚å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰è¿™ä¸ªåç§°ï¼Œåˆ™è¿”å›BADADDR
( -1 )ã€‚</p>
<h3 id="locbynameex">LocByNameEx</h3>
<p>long LocByNameEx(long funcaddrï¼Œ string loca
1name)ï¼Œåœ¨åŒ…å«funcaddrçš„å‡½æ•°ä¸­æœç´¢ç»™å®šçš„å±€éƒ¨åç§°ã€‚å¦‚æœç»™å®šçš„å‡½æ•°ä¸­æ²¡æœ‰è¿™ä¸ªåç§°ï¼Œåˆ™è¿”å›BADADDR
( -1 )o</p>
<h1 id="æ“ä½œæ•°æ®åº“çš„å‡½æ•°">æ“ä½œæ•°æ®åº“çš„å‡½æ•°</h1>
<p>æœ‰å¤§é‡å‡½æ•°å¯ç”¨äºå¯¹æ•°æ®åº“çš„å†…å®¹è¿›è¡Œæ ¼å¼åŒ–ã€‚è¿™äº›å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="makeunkn">MakeUnkn</h3>
<p>void MakeUnkn(long addr. long flags)ï¼Œ</p>
<p>å–æ¶ˆä½äºæŒ‡å®šåœ°å€çš„é¡¹çš„å®šä¹‰ã€‚</p>
<p>è¿™é‡Œçš„æ ‡å¿—(å‚è§IDCçš„MakeUnknæ–‡æ¡£ï¼‰æŒ‡å‡ºæ˜¯å¦ä¹Ÿå–æ¶ˆéšåçš„é¡¹çš„å®šä¹‰</p>
<p>ä»¥åŠæ˜¯å¦åˆ é™¤ä»»ä½•ä¸å–æ¶ˆå®šä¹‰çš„é¡¹æœ‰å…³çš„åç§°ã€‚</p>
<p>ç›¸å…³å‡½æ•°MakeUnknown å…è®¸ä½ å–æ¶ˆå¤§å—æ•°æ®çš„å®šä¹‰ã€‚</p>
<h3 id="makecode">MakeCode</h3>
<p>long MakeCode(1ong addr)ï¼Œ</p>
<p>å°†ä½äºæŒ‡å®šåœ°å€çš„å­—èŠ‚è½¬æ¢æˆä¸€æ¡æŒ‡ä»¤ã€‚</p>
<p>å¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›æŒ‡ä»¤çš„é•¿åº¦ï¼Œ</p>
<p>å¦åˆ™è¿”å›0ã€‚</p>
<h3 id="makebyte">MakeByte</h3>
<p>bool MakeByte(long addr)ï¼Œ</p>
<p>å°†ä½äºæŒ‡å®šåœ°å€çš„é¡¹ç›®è½¬æ¢æˆä¸€ä¸ªæ•°æ®å­—èŠ‚ã€‚</p>
<p>ç±»ä¼¼çš„å‡½æ•°è¿˜åŒ…æ‹¬Makewordå’Œ MakeDwordã€‚</p>
<h3 id="makecomm">MakeComm</h3>
<p>boo1 MakeComm(long addr. string comment)ï¼Œ</p>
<p>åœ¨ç»™å®šçš„åœ°å€å¤„æ·»åŠ ä¸€æ¡å¸¸è§„æ³¨é‡Šã€‚</p>
<h3 id="makefunction">MakeFunction</h3>
<p>bool MakeFunction(long beginï¼Œlong end)ï¼Œ</p>
<p>å°†ç”±beginåˆ°end çš„æŒ‡ä»¤è½¬æ¢æˆä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœendè¢«æŒ‡å®šä¸ºBADADDR (
-1)ï¼ŒIDAä¼šå°è¯•é€šè¿‡å®šä½å‡½æ•°çš„è¿”å›æŒ‡ä»¤ï¼Œæ¥è‡ªåŠ¨ç¡®å®šè¯¥å‡½æ•°çš„ç»“æŸåœ°å€ã€‚</p>
<p>å¼€å§‹çš„åœ°å€,æ¯”å¦‚è¯´push esi</p>
<p>ç»“æŸçš„åœ°å€,
retné‚£ä¸ªåœ°å€ä¸æ˜¯ç»“æŸ,retnä¹‹å¤–é‚£ä¸ªåœ°å€,æ‰æ˜¯,ç»“æŸçš„åœ°å€ä¸å±äºå‡½æ•°åœ°å€,æ˜¯å‡½æ•°åœ°å€çš„è¾¹ç•Œ</p>
<pre><code>#include &lt;idc.idc&gt;
static Y_MakeFunction(IP_start,IP_end)
{
    auto tmp=0;//å…ˆä»å¼€å§‹çš„IPå–æ¶ˆå®šä¹‰,ç„¶åå†ç”Ÿæˆå‡½æ•°
    tmp=MakeFunction(IP_start,IP_end);
    if(tmp==1)
    {
        Message(&quot;make func ok\n&quot;);
    }
    else
    {
        Message(&quot;make func failed\n&quot;);
    }
}
static main(void)
{

    Message(&quot;work begin\n&quot;);

    Y_MakeFunction(0x0040A188,0x0040A1AA);

    Message(&quot;work done\n&quot;);
}</code></pre>
<p>è¿è¡Œè¾“å‡º</p>
<pre><code>work begin
make func ok
work done</code></pre>
<h3 id="makestr">MakeStr</h3>
<p>bool MakeStr(1ong beginï¼Œlong end)ï¼Œ</p>
<p>åˆ›å»ºä¸€ä¸ªå½“å‰å­—ç¬¦ä¸²(ç”±GetStringTypeè¿”å›)ç±»å‹çš„å­—ç¬¦ä¸²,</p>
<p>æ¶µç›–ç”±beginåˆ°end-1ä¹‹é—´çš„æ‰€æœ‰å­—èŠ‚ã€‚</p>
<p>å¦‚æœendè¢«æŒ‡å®šä¸ºBADADDR,IDAä¼šå°è¯•è‡ªåŠ¨ç¡®å®šå­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚</p>
<h1 id="æ•°æ®åº“æœç´¢å‡½æ•°">æ•°æ®åº“æœç´¢å‡½æ•°</h1>
<p>åœ¨IDCä¸­ï¼ŒIDAçš„ç»å¤§éƒ¨åˆ†æœç´¢åŠŸèƒ½å¯é€šè¿‡å„ç§FindXXXå‡½æ•°æ¥å®ç°ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»‹ç»å…¶ä¸­ä¸€äº›å‡½æ•°ã€‚FindXXXå‡½æ•°ä¸­çš„flagså‚æ•°æ˜¯ä¸€ä¸ªä½æ©ç ï¼Œå¯ç”¨äºæŒ‡å®šæŸ¥æ‰¾æ“ä½œçš„è¡Œä¸ºã€‚3ä¸ªæœ€ä¸ºå¸¸ç”¨çš„æ ‡å¿—åˆ†åˆ«ä¸ºSEARCH_DOWNï¼Œå®ƒæŒ‡ç¤ºæœç´¢æ“ä½œæ‰«æé«˜ä½åœ°å€;SEARCH_NEXTï¼Œå®ƒç•¥è¿‡å½“å‰åŒ¹é…é¡¹ï¼Œä»¥æœç´¢ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹;SEARCH_CASEï¼Œå®ƒä»¥åŒºåˆ†å¤§å°å†™çš„æ–¹å¼è¿›è¡ŒäºŒè¿›åˆ¶å’Œæ–‡æœ¬æœç´¢ã€‚</p>
<h3 id="findcode">FindCode</h3>
<p>long FindCode(long addr, long flags)ï¼Œ</p>
<p>ä»ç»™å®šçš„åœ°å€æœç´¢ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</p>
<h3 id="finddata">FindData</h3>
<p>long FindData(long addr.long flags)ï¼Œä»ç»™å®šçš„åœ°å€æœç´¢ä¸€ä¸ªæ•°æ®é¡¹ã€‚</p>
<h3 id="findbinary">FindBinary</h3>
<p>long FindBinary(long addrï¼Œlong flagsï¼Œstring binary)</p>
<p>ä»ç»™å®šçš„åœ°å€addræœç´¢16è¿›åˆ¶å­—ç¬¦ä¸²åºåˆ—binary</p>
<p>è¿”å›è¯¥å­—èŠ‚ç å‡ºç°çš„åœ°å€</p>
<pre><code>flagå–å€¼æœ‰ï¼šå¯é€‰é¡¹
SEARCH_DOWN å‘ä¸‹æœç´¢
SEARCH_UP å‘ä¸Šæœç´¢
SEARCH_NEXT è·å–ä¸‹ä¸€ä¸ªæ‰¾åˆ°çš„å¯¹è±¡ã€‚
SEARCH_CASE æŒ‡å®šå¤§å°å†™æ•æ„Ÿåº¦
SEARCH_UNICODE æœç´¢ Unicode å­—ç¬¦ä¸²ã€‚</code></pre>
<h3 id="findtext">FindText</h3>
<p>long FindText(long addr.long flags.1ong row.long columnï¼Œstring
text)ï¼Œ</p>
<p>åœ¨ç»™å®šçš„åœ°å€ï¼Œä»ç»™å®šè¡Œ(
row)çš„ç»™å®šåˆ—æœç´¢å­—ç¬¦ä¸²textã€‚æ³¨æ„ï¼ŒæŸä¸ªç»™å®šåœ°å€çš„åæ±‡ç¼–æ–‡æœ¬.å¯èƒ½ä¼šè·¨è¶Šå‡ è¡Œï¼Œå› æ­¤,ä½ éœ€è¦æŒ‡å®šæœç´¢åº”ä»å“ªä¸€è¡Œå¼€å§‹ã€‚è¿˜è¦æ³¨æ„çš„æ˜¯ï¼ŒSEARCH_NEXTå¹¶æœªå®šä¹‰æœç´¢çš„æ–¹å‘ï¼Œæ ¹æ®SEARCH_DOWN
æ ‡å¿—ï¼Œå…¶æ–¹å‘å¯èƒ½å‘ä¸Šä¹Ÿå¯èƒ½å‘ä¸‹ã€‚æ­¤å¤–ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®SEARCH_NEXTï¼Œä¸”
addrä½ç½®çš„é¡¹ä¸æœç´¢æ¡ä»¶åŒ¹é…ï¼Œåˆ™FindXXXå‡½æ•°å¾ˆå¯èƒ½ä¼šè¿”å›addrå‚æ•°ä¼ é€’ç»™è¯¥å‡½æ•°çš„åœ°å€ã€‚</p>
<h1 id="æ“ä½œå‡½æ•°">æ“ä½œå‡½æ•°</h1>
<p>è®¸å¤šè„šæœ¬ä¸“ç”¨äºåˆ†ææ•°æ®åº“ä¸­çš„å‡½æ•°ã€‚</p>
<p>IDAä¸ºç»è¿‡åæ±‡ç¼–çš„å‡½æ•°åˆ†é…å¤§é‡å±æ€§ï¼Œå¦‚å‡½æ•°å±€éƒ¨å˜é‡åŒºåŸŸçš„å¤§å°ã€å‡½æ•°çš„å‚æ•°åœ¨è¿è¡Œæ—¶æ ˆä¸Šçš„å¤§å°ã€‚</p>
<p>ä¸‹é¢çš„IDCå‡½æ•°å¯ç”¨äºè®¿é—®ä¸æ•°æ®åº“ä¸­çš„</p>
<h3 id="getfunctionattr">GetFunctionAttr</h3>
<p>long GetFunctionAttr(long addr, 1ong attrib)ï¼Œ</p>
<p>è¿”å›åŒ…å«ç»™å®šåœ°å€çš„å‡½æ•°çš„è¢«è¯·æ±‚çš„å±æ€§</p>
<p>ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾ä¸€ä¸ªå‡½æ•°çš„ç»“æŸåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨GetFunctionAttr(addr.
FUNCATTR_END)</p>
<pre><code>funcStart = GetFunctionAttr(origEA,FUNCATTR_START);
funcEnd = GetFunctionAttr(origEA,FUNCATTR_END)</code></pre>
<h3 id="getfunctionname">GetFunctionName</h3>
<p>string GetFunctionName(long addr)</p>
<p>å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€</p>
<p>è¿”å›å½“å‰æŒ‡ä»¤å±äºå“ªä¸ªå‡½æ•°</p>
<p>å¦‚æœç»™å®šçš„åœ°å€å¹¶ä¸å±äºä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ä¸²â€ â€</p>
<h3 id="nextfunction">NextFunction</h3>
<p>auto NextFunction(auto addr)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€åçš„ä¸‹ä¸€ä¸ªå‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<p>å¦‚æœæ•°æ®åº“ä¸­ç»™å®šåœ°å€åæ²¡æœ‰å…¶ä»–å‡½æ•°ï¼Œåˆ™è¿”å›-1ã€‚</p>
<h3 id="prevfunction">PrevFunction</h3>
<p>1ong PrevFunction(1ong addr)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€ä¹‹å‰è·ç¦»æœ€è¿‘çš„å‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<p>å¦‚æœåœ¨ç»™å®šåœ°å€ä¹‹å‰æ²¡æœ‰å‡½æ•°ï¼Œåˆ™è¿”å›-1ã€‚</p>
<p>æ ¹æ®å‡½æ•°çš„åç§°ï¼Œä½¿ç”¨LocByNameå‡½æ•°æŸ¥æ‰¾è¯¥å‡½æ•°çš„èµ·å§‹åœ°å€ã€‚</p>
<h1 id="ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°">ä»£ç äº¤å‰å¼•ç”¨å‡½æ•°</h1>
<h3 id="rfirst">Rfirst</h3>
<p>long Rfirst(long from)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€å‘å…¶è½¬äº¤æ§åˆ¶æƒçš„ç¬¬â€“ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœç»™å®šçš„åœ°å€æ²¡æœ‰å¼•ç”¨å…¶ä»–åœ°å€ï¼Œåˆ™è¿”å›BADADDR ( -1 )</p>
<h3 id="rnext">Rnext</h3>
<p>long Rnext(1ong fromï¼Œlong current)ï¼Œ</p>
<p>å¦‚æœcurrent å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨Rfirstæˆ–Rnextæ—¶è¿”å›,</p>
<p>åˆ™è¿”å›ç»™å®šåœ°å€( from )è½¬äº¤æ§åˆ¶æƒçš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å…¶ä»–äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚</p>
<h3 id="xreftype">XrefType</h3>
<p>long XrefType()ï¼Œ</p>
<p>è¿”å›-ä¸ªå¸¸é‡ï¼Œè¯´æ˜æŸä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ï¼ˆå¦‚Rfirst)</p>
<p>è¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚å¯¹äºä»£ç äº¤å‰å¼•ç”¨ï¼Œè¿™äº›å¸¸é‡åŒ…æ‹¬fl_CN(è¿‘è°ƒç”¨)ã€fl_CF(è¿œè°ƒç”¨)ã€f1_JNï¼ˆè¿‘è·³è½¬)ã€f1_JFï¼ˆè¿œè·³è½¬ï¼‰å’Œf1_F(æ™®é€šé¡ºåºæµ)ã€‚</p>
<h3 id="rfirstb">RfirstB</h3>
<p>long RfirstB(long to)ï¼Œ</p>
<p>è¿”å› è½¬äº¤æ§åˆ¶æƒåˆ°ç»™å®šåœ°å€çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å¯¹ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR( -1 )ã€‚</p>
<h3 id="rnextb">RnextB</h3>
<p>long RnextB(1ong to. long current)ï¼Œ</p>
<p>å¦‚æœcurrent
å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨RfirstBæˆ–RnextBæ—¶è¿”å›ï¼Œåˆ™è¿”å›ä¸‹ä¸€ä¸ªè½¬äº¤æ§åˆ¶æƒåˆ°ç»™å®šåœ°å€(to)çš„ä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å…¶ä»–å¯¹ç»™å®šä½ç½®çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR ( -1 ).</p>
<p>æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªäº¤å‰å¼•ç”¨å‡½æ•°ï¼Œ</p>
<p>IDAéƒ½ä¼šè®¾ç½®ä¸€ä¸ªå†…éƒ¨
IDCçŠ¶æ€å˜é‡,æŒ‡å‡ºè¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚å¦‚æœéœ€è¦çŸ¥é“ä½ æ”¶åˆ°çš„äº¤å‰å¼•ç”¨çš„ç±»å‹,é‚£ä¹ˆåœ¨è°ƒç”¨å…¶ä»–äº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨XrefTypeå‡½æ•°ã€‚</p>
<h1 id="æ•°æ®äº¤å‰å¼•ç”¨">æ•°æ®äº¤å‰å¼•ç”¨</h1>
<p>è®¿é—®æ•°æ®äº¤å‰å¼•ç”¨ä¿¡æ¯çš„å‡½æ•°ä¸è®¿é—®ä»£ç äº¤å‰å¼•ç”¨ä¿¡æ¯çš„å‡½æ•°éå¸¸ç±»ä¼¼ã€‚è¿™äº›å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<h3 id="dfirst">Dfirst</h3>
<p>long Dfirst(long from)ï¼Œ</p>
<p>è¿”å›ç»™å®šåœ°å€å¼•ç”¨ä¸€ä¸ªæ•°æ®å€¼çš„ç¬¬â€“ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœç»™å®šåœ°å€æ²¡æœ‰å¼•ç”¨å…¶ä»–åœ°å€ï¼Œåˆ™è¿”å›BADADDR ( -1 )ã€‚</p>
<h3 id="dnext">Dnext</h3>
<p>long Dnext(1ong fromï¼Œlong current)</p>
<p>å¦‚æœcurrentå·²ç»åœ¨å‰â€“æ¬¡è°ƒç”¨Dfirstæˆ–Dnextæ—¶è¿”å›ï¼Œåˆ™è¿”å›ç»™å®šåœ°å€( from
)</p>
<p>å‘å…¶å¼•ç”¨ä¸€ä¸ªæ•°æ®å€¼çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å…¶ä»–äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚</p>
<h3 id="xreftype-1">XrefType()</h3>
<p>long XrefType()ï¼Œè¿”å›ä¸€ä¸ªå¸¸é‡ï¼Œè¯´æ˜æŸä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ï¼ˆå¦‚
Dfirst)è¿”å›çš„æœ€åä¸€ä¸ªäº¤å‰å¼•ç”¨çš„ç±»å‹ã€‚</p>
<p>å¯¹äºæ•°æ®äº¤å‰å¼•ç”¨ï¼Œè¿™äº›å¸¸é‡åŒ…æ‹¬dr_0(æä¾›çš„åç§»é‡)ã€dr_w(æ•°æ®å†™äººï¼‰å’Œdr_Rï¼ˆæ•°æ®è¯»å–)</p>
<h3 id="dfirstb">DfirstB</h3>
<p>long DfirstB(1ong to)</p>
<p>è¿”å›å°†ç»™å®šåœ°å€ä½œä¸ºæ•°æ®å¼•ç”¨çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p>
<p>å¦‚æœä¸å­˜åœ¨å¼•ç”¨ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨ï¼Œåˆ™è¿”å›BADADDR ( -1 )</p>
<h3 id="dnextb">DnextB</h3>
<p>long DnextB(long toï¼Œ1ong current)ï¼Œå¦‚æœcurrnet
å·²ç»åœ¨å‰ä¸€æ¬¡è°ƒç”¨DfristBæˆ–DnextBæ—¶è¿”å›ï¼Œåˆ™è¿”å›å°†ç»™å®šåœ°å€(
to)ä½œä¸ºæ•°æ®å¼•ç”¨çš„ä¸‹ä¸€æ¬¡ä½ç½®ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–å¯¹ç»™å®šåœ°å€çš„äº¤å‰å¼•ç”¨å­˜åœ¨ï¼Œåˆ™è¿”å›BADADDRã€‚å’Œä»£ç äº¤å‰å¼•ç”¨ä¸€æ ·ï¼Œå¦‚æœéœ€è¦çŸ¥é“ä½ æ”¶åˆ°çš„äº¤å‰å¼•ç”¨çš„ç±»å‹ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨å¦ä¸€ä¸ªäº¤å‰å¼•ç”¨æŸ¥è¯¢å‡½æ•°ä¹‹å‰ï¼Œå¿…é¡»è°ƒç”¨XrefTypeå‡½æ•°</p>
<h1 id="åæ±‡ç¼–æå–">åæ±‡ç¼–æå–</h1>
<p>è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä»åæ±‡ç¼–ä»£ç æ¸…å•çš„åæ±‡ç¼–è¡Œä¸­æå–å‡ºæ–‡æœ¬æˆ–æ–‡æœ¬çš„æŸä¸ªéƒ¨åˆ†ã€‚ä¸‹é¢çš„å‡½æ•°å¯ç”¨äºè®¿é—®åæ±‡ç¼–è¡Œçš„å„ç§ç»„ä»¶</p>
<h2 id="getdisasm">GetDisasm</h2>
<p>string GetDisasm(long
addr)ï¼Œè¿”å›ç»™å®šåœ°å€çš„åæ±‡ç¼–æ–‡æœ¬ã€‚è¿”å›çš„æ–‡æœ¬åŒ…æ‹¬ä»»ä½•æ³¨é‡Šï¼Œä½†ä¸åŒ…æ‹¬åœ°å€ä¿¡æ¯</p>
<p>è¿”å›è¯¥åœ°å€çš„åæ±‡ç¼–æŒ‡ä»¤</p>
<pre><code>#include &lt;idc.idc&gt;

static main()
{
    auto currAddr=0;
    auto op =&quot; &quot;;
    currAddr    = ScreenEA();
    op=GetDisasm(currAddr);
    Message(&quot;%s\n&quot;,op);
}</code></pre>
<p>è¾“å‡º</p>
<p><code>mov     edx, dword_445BD8</code></p>
<p>æ³¨æ„è¿”å›çš„å­—ç¬¦ä¸²,movå’Œedxä¹‹é—´æ˜¯4ä¸ªç©ºæ ¼</p>
<h2 id="getmnem">GetMnem</h2>
<p>string GetMnem( auto addr)</p>
<p>è¿”å›ä½äºç»™å®šåœ°å€çš„æ±‡ç¼–æŒ‡ä»¤,æ¯”å¦‚è¿”å›â€callâ€,â€œjmpâ€</p>
<p>å¦‚æœè¯¥åœ°å€æ²¡æœ‰æŒ‡ä»¤ä¸ä¹‹åŒ¹é…å°±è¿”å›â€ â€</p>
<h2 id="getopnd">GetOpnd</h2>
<p>string GetOpnd(long addr. long opnum)ï¼Œ</p>
<p>è¿”å›æŒ‡å®šåœ°å€æ±‡ç¼–æŒ‡ä»¤çš„çš„æ“ä½œæ•°</p>
<p>IDAä»¥0ä¸ºèµ·å§‹ç¼–å·ï¼Œä»å·¦å‘å³å¯¹æ“ä½œæ•°ç¼–å·ã€‚</p>
<h2 id="getoptype">GetOpType</h2>
<p>long GetOpType(long addr.long
opnum)ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡å‡ºç»™å®šåœ°å€çš„ç»™å®šæ“ä½œæ•°çš„ç±»å‹ã€‚è¯·å‚è€ƒGetOpTypeçš„
IDCæ–‡æ¡£ï¼Œäº†è§£æ“ä½œæ•°ç±»å‹ä»£ç ã€‚</p>
<h2 id="getoperandvalue">GetOperandValue</h2>
<p>long GetOperandValue(long addr. long
opnum)ï¼Œè¿”å›ä¸ç»™å®šåœ°å€çš„ç»™å®šæ“ä½œæ•°æœ‰å…³çš„æ•´æ•°å€¼ã€‚è¿”å›å€¼çš„æ€§è´¨å–å†³äºGetOpTypeæŒ‡å®šçš„ç»™å®šæ“ä½œæ•°çš„ç±»å‹ã€‚15.5
IDCè„šæœ¬ç¤ºä¾‹211string CommentEx(long addr. long
type)ï¼Œè¿”å›ç»™å®šåœ°å€å¤„çš„æ³¨é‡Šæ–‡æœ¬ã€‚å¦‚æœtypeä¸º0,åˆ™è¿”å›å¸¸è§„æ³¨é‡Šçš„æ–‡æœ¬;å¦‚æœtypeä¸º1ï¼Œåˆ™è¿”å›å¯é‡å¤æ³¨é‡Šçš„æ–‡æœ¬ã€‚å¦‚æœç»™å®šåœ°å€å¤„æ²¡æœ‰æ³¨é‡Š,åˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p>
<h2 id="itemsize">ItemSize</h2>
<p>è¿”å›æ±‡ç¼–æŒ‡ä»¤çš„é•¿åº¦</p>
<pre><code>ItemSize(ç»™å®šåœ°å€)</code></pre>
<pre><code>.text:00000000004018B6 8B 04 25 54 30 60 00          mov     eax, ds:zero2</code></pre>
<p>å¦‚æœaddræ˜¯00000000004018B6,åˆ™å‡½æ•°è¿”å›7</p>
<p>å¦‚æœaddræ˜¯00000000004018B7,åˆ™å‡½æ•°è¿”å›6</p>
<p>â€¦ä»¥æ­¤ç±»æ¨</p>
<h2 id="getregvaluerip">GetRegValue(â€œRIPâ€)</h2>
<p>GetRegValue(â€œRIPâ€)</p>
<p>å°±è¿™æ ·å°±å¯ä»¥è·å–æŸä¸ªå¯„å­˜å™¨çš„å€¼</p>
<h2 id="get_func_name">get_func_name</h2>
<p>è·å–å¯¹åº”åœ°å€æ‰€åœ¨å‡½æ•°çš„åå­—</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> funcName <span class="op">=</span> get_func_name<span class="op">(</span>start_func_addr<span class="op">);</span></span></code></pre></div>
<h1 id="misc-func">misc-func</h1>
<p>MinEA() MaxEA() è·å–å½“å‰idb çš„æœ€å°åœ°å€ å’Œ æœ€å¤§åœ°å€</p>
<p>ScreenEA() è·å–å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„åœ°å€, è¿”å›ä¸€ä¸ª int ç±»å‹</p>
<p>SegName(ea) eaæ˜¯ä¸€ä¸ªå˜é‡å­˜å‚¨å½“å‰åœ°å€, è¿™ä¸ªapi
æ˜¯è·å–å½“å‰åœ°å€æ‰€åœ¨çš„æ®µ</p>
<p>GetDisasm(ea) è·å–å½“å‰åœ°å€çš„åæ±‡ç¼–ä»£ç </p>
<p>GetMnem(ea) è·å–å½“å‰åœ°å€çš„æ“ä½œç </p>
<p>GetOpnd(ea,0) è·å–å½“å‰åœ°å€çš„æ“ä½œæ•°,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå“ªä¸€ä¸ªæ“ä½œæ•°</p>
<p>SegStart(ea) è·å–å½“å‰åœ°å€æ‰€åœ¨æ®µçš„èµ·å§‹åœ°å€</p>
<p>SegEnd(ea) è·å–å½“å‰åœ°å€çš„æ®µå°¾åœ°å€</p>
<p>NextSeg(ea) è·å–ä¸‹ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€</p>
<p>idautils.Segments() è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡æ•°ç»„</p>
<p>GetFunctionName(func) é€šè¿‡åœ°å€,è·å–å‡½æ•°çš„åç§°</p>
<p>idautils.Functions() è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å‡½æ•°é¦–åœ°å€æ•°ç»„,</p>
<p>idaapi.get_func(ea) è·å–å½“å‰åœ°å€çš„å‡½æ•°é¦–åœ°å€å’Œå°¾åœ°å€</p>
<p>NextFunction(ea)
è·å–ä¸‹ä¸€ä¸ªå‡½æ•°åœ°å€,eaçš„å€¼å¯èƒ½åœ¨å‡½æ•°é‡Œé¢,ä¹Ÿå¯èƒ½åœ¨å‡½æ•°å¤–é¢,ä½†æ˜¯ä¼šè¿”å›ä¸‹ä¸€ä¸ªå‡½æ•°çš„é¦–åœ°å€</p>
<p>PrevFunction(ea) è·å–å‰ä¸€ä¸ªå‡½æ•°åœ°å€</p>
<p>GetFunctionAttr(ea,FUNCATTR_START) è·å–ä¸€ä¸ªå‡½æ•°çš„è¾¹ç•Œåœ°å€</p>
<p>GetDunctionAttr(ea,FUNCATTR_END) è·å–ä¸€ä¸ªå‡½æ•°çš„è¾¹ç•Œåœ°å€</p>
<p>NextHead</p>
<pre><code>auto NextHead(auto å½“å‰åœ°å€,auto ç»“å°¾åœ°å€)
//head = NextHead(startOEP, End_FUnc);
//head = NextHead(0x00000000, 0xFFFFFFFF);</code></pre>
<p>è·å–ä¸€ä¸ªå½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€,éå†ç»“æŸè¿”å›-1</p>
<p>å‡½æ•°çš„ä¸è¶³æ˜¯:</p>
<p>å¦‚æœé‡åˆ°èŠ±æŒ‡ä»¤,æ¯”å¦‚</p>
<pre><code>A1AA F9                                                                       stc
CAT1:0040A1AB 72 03                                                           jb      short loc_40A1B0
CAT1:0040A1AD                                                                 db      64h
CAT1:0040A1AD 64 E3 8F                                                        jecxz   short loc_40A13F</code></pre>
<p>ä»–æ˜¯ä¸ä¼šè¿”å›db 64hçš„åœ°å€çš„</p>
<p>SetColor</p>
<p>SetColor(auto åœ°å€, CIC_ITEM, 16è¿›åˆ¶é¢œè‰²å€¼);</p>
<p>get_idb_path()[0:-4]</p>
<pre><code>#include &lt;idc.idc&gt;
static main(void)
{
    Message(&quot;%s\n&quot;,get_idb_path()[0:-4]);
}
//è¾“å‡ºå½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•,å…·ä½“æ˜¯å½“å‰idbæ–‡ä»¶æ‰€åœ¨ç›®å½•</code></pre>
<h1 id="é™„å½•">é™„å½•</h1>
<p>ä¸€ä¸ªå¾ˆå¥½çš„IDAèµ„æºæ’ä»¶ä»‹ç»,æ²¡å»ä¸‹è½½åº”ç”¨</p>
<p><a
href="https://www.dazhuanlan.com/sisiyoki/topics/1183415">https://www.dazhuanlan.com/sisiyoki/topics/1183415</a></p>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
