<!doctype html>
<html >
<head>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!--[if lt IE 9]>
                <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <!-- <link rel="stylesheet" type="text/css" href="template.css" /> -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/template.css" />

    <link href="https://vjs.zencdn.net/5.4.4/video-js.css" rel="stylesheet" />

    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script type='text/javascript' src='menu/js/jquery.cookie.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.hoverIntent.minified.js'></script> -->
    <!-- <script type='text/javascript' src='menu/js/jquery.dcjqaccordion.2.7.min.js'></script> -->

    <!-- <link href="menu/css/skins/blue.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/graphite.css" rel="stylesheet" type="text/css" /> -->
    <!-- <link href="menu/css/skins/grey.css" rel="stylesheet" type="text/css" /> -->
  
    <!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
        
  
    <!-- <script src="script.js"></script> -->
  
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.cookie.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.hoverIntent.minified.js'></script>
    <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/js/jquery.dcjqaccordion.2.7.min.js'></script>

    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/blue.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/graphite.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/menu/css/skins/grey.css" rel="stylesheet" type="text/css" />
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/gh/diversen/pandoc-bootstrap-adaptive-template@959c3622/jquery.sticky-kit.js"></script>
    <meta name="generator" content="pandoc" />
  <title>wiki-Reverse-Android-浅谈-软件破解</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>

    
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">wiki-Reverse-Android-浅谈-软件破解</span>
        <ul class="nav pull-right doc-info">
                            </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">

        <ul>
        <li><a href="#保护技术" id="toc-保护技术">保护技术</a>
        <ul>
        <li><a href="#试用版软件"
        id="toc-试用版软件">试用版软件</a></li>
        <li><a href="#序列号保护"
        id="toc-序列号保护">序列号保护</a></li>
        <li><a href="#网络验证" id="toc-网络验证">网络验证</a></li>
        <li><a href="#应用内付费"
        id="toc-应用内付费">应用内付费</a></li>
        <li><a href="#google-play-license"
        id="toc-google-play-license">Google Play License</a></li>
        <li><a href="#重启验证" id="toc-重启验证">重启验证</a></li>
        </ul></li>
        <li><a href="#反破解" id="toc-反破解">反破解</a>
        <ul>
        <li><a href="#对抗工具" id="toc-对抗工具">对抗工具</a></li>
        <li><a href="#对抗人" id="toc-对抗人">对抗人</a></li>
        </ul></li>
        <li><a href="#防止重编译"
        id="toc-防止重编译">防止重编译</a></li>
        <li><a href="#系统安全" id="toc-系统安全">系统安全</a>
        <ul>
        <li><a href="#组件安全" id="toc-组件安全">组件安全</a>
        <ul>
        <li><a href="#activity安全activity劫持"
        id="toc-activity安全activity劫持">activity安全，activity劫持</a></li>
        </ul></li>
        </ul></li>
        </ul>

        </div>
      </div>
            <div class="span9">

      
      <h1 id="保护技术">保护技术</h1>
<h2 id="试用版软件">试用版软件</h2>
<blockquote>
<p>免费试用版</p>
</blockquote>
<p>免费试用版的软件通常有一个免费使用期限或次数的限制，当达到了使用期限或软件的免费次数使用完后，软件会提示软件免费试用过期，然后提醒用户购买软件。</p>
<p>特点：功能完全，但只能免费用有限次</p>
<blockquote>
<p>演示版</p>
</blockquote>
<p>演示版软件一般只提供了软件的部分功能供用户使用，此类软件通常是“免费”的，用户要想使用软件的全部功能则需要向软件作者购买正式版的软件，作者会提供完整版的安装包及使用授权。</p>
<p>特点：功能不完全，完整版需要另外下载</p>
<blockquote>
<p>限制功能免费版</p>
</blockquote>
<p>限制功能免费版的软件通常将软件根据功能分成几个级别，例如免费版、高级版、专业版等。</p>
<p>免费版只提供最基础的功能，而专业版或高级版则提供更多或者全部的软件功能，根据作者的授权风格不同，这三种级别的软件可能使用同一个软件安装包，通过不同的授权来区别使用权限，或者使用不同的安装包提供不同的软件功能。</p>
<h2 id="序列号保护">序列号保护</h2>
<ul>
<li>算法设计是一个很费脑子的事情</li>
<li>一些公司会去专门购买算法，如果某个算法被破解，那么对应的一系列软件也会gg</li>
</ul>
<p>除了拥有强劲的算法，还需要有良好的注册验证技巧，一款序列号保护的软件即使算法再强大，而验证上只是做了简单正确与否的比较，这样的保护将会是形同虚设，Cracker只需修改软件的跳转（可能只需一个字节）就可以将软件破解。在这里笔者给出几点序列号保护的建议:</p>
<ul>
<li>序列号加入PC机器码验证，做到一机一码。</li>
<li>使用NDK
编写注册模块。将软件注册版提供的功能进行加密，例如对相关代码或数据使用AES、DES等加密算法进行加密，软件在运行时检测注册信息，如果是注册版用户则根据注册信息生成正确的解密密钥，最后使用这个密钥对注册版功能进行解密。根据注册信息生成密钥的一种思路可以是:在判断用户注册码正确的情况下，取注册码的前8位对其每个字节进行异或运算，然后使用这8位异或后的字节作为加密密钥，对注册功能代码的解密密钥进行AES/DES
加密运算（AES/DES的加密密钥即为解密密钥)，将生成的加密数据写入程序的配置文件(SharedProferences或File都可以)，软件在运行时读取该数据对代码进行解密，解密成功即说明是注册版用户。</li>
<li>加入其它类型的保护方式。多种保护方式比单一的保护肯定要安全得多</li>
<li>其它的保护建议请参看本书第10章介绍的反破解技术。</li>
</ul>
<h2 id="网络验证">网络验证</h2>
<p>网络验证是指软件在运行时需要联网进行一些验证。网络连接方式可以是
Socket连接与HTTP连接，验证的内容可以是软件注册信息验证、代码完整性验证以及软件功能解密等。</p>
<p>软件通过网络向验证服务器请求反馈信息</p>
<ul>
<li>静态信息</li>
<li>动态信息</li>
<li>交互式信息</li>
</ul>
<p>心跳包检测：一旦软件与服务器断开连接，软件就拒绝提供任何功能或者干脆停止运行。</p>
<p>应对方法：</p>
<p>抓包，wireshark，tcpdump，burp</p>
<p>tcpdump</p>
<p>抓包指令？</p>
<pre><code>adb shell tcpdump -p -vv -s 0 -w / sdcard/ capture.pcap</code></pre>
<p>回到程序的界面，点击“执行功能”按钮，然后回到命令提示窗口按下CTRL+C停止抓包</p>
<h2 id="应用内付费">应用内付费</h2>
<p>以后看</p>
<h2 id="google-play-license">Google Play License</h2>
<h2 id="重启验证">重启验证</h2>
<p>Android系统保存信息的方法有限，只能是内部存储、外部存储、数据库与SharedProferences等4种方式。</p>
<p>破解者通常可以在短时间内找到注册信息的保存位置，</p>
<ul>
<li><p>单-一保护。重启验证保护模块使用Java代码编写，注册信息加密保存到内部存储中。</p></li>
<li><p>单一保护。重启验证保护模块使用Native代码编写，注册信息加密保存到内部存储中。</p></li>
<li><p>多重保护。重启验证保护模块使用Native代码编写，并在代码中加入网络验证。</p></li>
</ul>
<p>​</p>
<p>使用Native代码编写重启验证保护模块则相对好一些，但需要注意的是，代码中尽量不要使用明码比较，也不要在软件中只使用一个简单的条件判断就确定软件是否注册成功，而是要在注册功能的代码中插入多个验证点，或者插入一些暗桩代码。所谓暗桩代码是指在多个功能代码点插入注册验证代码，验证失败就退出程序。</p>
<p>暗桩代码的目的就是让破解者找不到验证点，在发现软件注册失败而被暴力破解的情况下，不定时的退出程序或者产生异常。</p>
<p>最后的多重保护是最有效的保护手法，将重启验证与网络验证结合，可以大大增加软件的破解难度，可以将软件的部分功能代码加密，只有注册成功后才能从网络中获取解密的方法或解密因子;也可以每次启动通过网络检查软件的完整性，或者设定软件有效使用时间等等，这些保护思路需要读者不断的总结，不停地思考来完善，笔者在此处也只能给出指导性的建议。</p>
<h1 id="反破解">反破解</h1>
<h2 id="对抗工具">对抗工具</h2>
<p>找到工具的缺陷，并加以利用</p>
<p>就是让工具束手无策，无能为力</p>
<ul>
<li>例如阅读工具的源代码，发现工具的漏洞点。很难QAQ</li>
<li>批量测试，也就是那一堆样本给工具测试，看工具有没有异常报错，</li>
</ul>
<p>比如让反编译工具 异常，崩溃，报错。</p>
<h2 id="对抗人">对抗人</h2>
<p>对代码
压缩shrinking，混淆Obfuscation，优化Optimition，反混淆栈跟踪Retarce</p>
<p>代码混淆</p>
<p>ndk保护：关键代码处用C实现</p>
<p>加壳：</p>
<ul>
<li>ndk层的加壳</li>
<li></li>
</ul>
<p>反动调</p>
<p>检测调试器</p>
<blockquote>
<p>AndroidManifest的字段</p>
</blockquote>
<p>检查ApplicationInfo.FLAG_DEBUGGABLE的值</p>
<p>android.os. Debug .isDebuggerConnected ( )</p>
<blockquote>
<p>模拟器检测</p>
</blockquote>
<p>手机和模拟器之间的区别，root和非root的区别</p>
<h1 id="防止重编译">防止重编译</h1>
<p>检测签名：签名内容是否一致，比如签名的发布时间</p>
<p>校验保护：检验某些文件的hash值是否变化</p>
<h1 id="系统安全">系统安全</h1>
<h2 id="组件安全">组件安全</h2>
<h3 id="activity安全activity劫持">activity安全，activity劫持</h3>
            </div>
    </div>
  </div>
  <script src="https://vjs.zencdn.net/5.4.4/video.js"></script>

</body>
</html>
